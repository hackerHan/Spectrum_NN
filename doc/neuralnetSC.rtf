{\rtf1\ansi\ansicpg1252\cocoartf1671\cocoasubrtf100
{\fonttbl\f0\fnil\fcharset134 PingFangSC-Regular;}
{\colortbl;\red255\green255\blue255;\red51\green110\blue109;\red0\green0\blue0;\red0\green0\blue0;
\red52\green110\blue183;\red83\green83\blue83;\red169\green14\blue26;\red15\green112\blue1;}
{\*\expandedcolortbl;;\cssrgb\c25098\c50196\c50196;\csgray\c0\c0;\cssrgb\c0\c0\c0\c87059;
\cssrgb\c25490\c51373\c76863;\cssrgb\c40000\c40000\c40000;\cssrgb\c72941\c12941\c12941;\cssrgb\c0\c50196\c0;}
\margl1440\margr1440\vieww10800\viewh8400\viewkind0
\deftab720
\pard\pardeftab720\sl340\partightenfactor0

\f0\fs24 \cf2 \cb3 \expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 #' @export\cf4 \strokec4 \
\pard\pardeftab720\sl340\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://rdrr.io/cran/neuralnet/man/neuralnet.html"}}{\fldrslt \cf5 \strokec5 neuralnet}} \cf6 \strokec6 <-\cf4 \strokec4 \
\pard\pardeftab720\sl340\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/function.html"}}{\fldrslt \cf5 \strokec5 function}} ({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/formula.html"}}{\fldrslt \cf5 \strokec5 formula}}, {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/utils/data.html"}}{\fldrslt \cf5 \strokec5 data}}, hidden \cf6 \strokec6 =\cf4 \strokec4  \cf6 \strokec6 1\cf4 \strokec4 , threshold \cf6 \strokec6 =\cf4 \strokec4  \cf6 \strokec6 0.01\cf4 \strokec4 , stepmax \cf6 \strokec6 =\cf4 \strokec4  \cf6 \strokec6 1e+05\cf4 \strokec4 , \
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/rep.html"}}{\fldrslt \cf5 \strokec5 rep}} \cf6 \strokec6 =\cf4 \strokec4  \cf6 \strokec6 1\cf4 \strokec4 , startweights \cf6 \strokec6 =\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/NULL.html"}}{\fldrslt \cf5 \strokec5 NULL}}, learningrate.limit \cf6 \strokec6 =\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/NULL.html"}}{\fldrslt \cf5 \strokec5 NULL}}, \
    learningrate.factor \cf6 \strokec6 =\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/list.html"}}{\fldrslt \cf5 \strokec5 list}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/cran/neuralnet/src/R/neuralnet.r"}}{\fldrslt \cf5 \strokec5 minus}} \cf6 \strokec6 =\cf4 \strokec4  \cf6 \strokec6 0.5\cf4 \strokec4 , {\field{\*\fldinst{HYPERLINK "https://rdrr.io/cran/neuralnet/src/R/neuralnet.r"}}{\fldrslt \cf5 \strokec5 plus}} \cf6 \strokec6 =\cf4 \strokec4  \cf6 \strokec6 1.2\cf4 \strokec4 ), learningrate \cf6 \strokec6 =\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/NULL.html"}}{\fldrslt \cf5 \strokec5 NULL}}, \
    lifesign \cf6 \strokec6 =\cf4 \strokec4  \cf7 \strokec7 "none"\cf4 \strokec4 , lifesign.step \cf6 \strokec6 =\cf4 \strokec4  \cf6 \strokec6 1000\cf4 \strokec4 , algorithm \cf6 \strokec6 =\cf4 \strokec4  \cf7 \strokec7 "rprop+"\cf4 \strokec4 , \
    err.fct \cf6 \strokec6 =\cf4 \strokec4  \cf7 \strokec7 "sse"\cf4 \strokec4 , act.fct \cf6 \strokec6 =\cf4 \strokec4  \cf7 \strokec7 "logistic"\cf4 \strokec4 , linear.output \cf6 \strokec6 =\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/logical.html"}}{\fldrslt \cf5 \strokec5 TRUE}}, \
    exclude \cf6 \strokec6 =\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/NULL.html"}}{\fldrslt \cf5 \strokec5 NULL}}, constant.weights \cf6 \strokec6 =\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/NULL.html"}}{\fldrslt \cf5 \strokec5 NULL}}, likelihood \cf6 \strokec6 =\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/logical.html"}}{\fldrslt \cf5 \strokec5 FALSE}}) \
\{\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/call.html"}}{\fldrslt \cf5 \strokec5 call}} \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/match.call.html"}}{\fldrslt \cf5 \strokec5 match.call}}()\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/options.html"}}{\fldrslt \cf5 \strokec5 options}}(scipen \cf6 \strokec6 =\cf4 \strokec4  \cf6 \strokec6 100\cf4 \strokec4 , digits \cf6 \strokec6 =\cf4 \strokec4  \cf6 \strokec6 10\cf4 \strokec4 )\
    result \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/cran/neuralnet/src/R/neuralnet.r"}}{\fldrslt \cf5 \strokec5 varify.variables}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/utils/data.html"}}{\fldrslt \cf5 \strokec5 data}}, {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/formula.html"}}{\fldrslt \cf5 \strokec5 formula}}, startweights, learningrate.limit, \
        learningrate.factor, learningrate, lifesign, algorithm, \
        threshold, lifesign.step, hidden, {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/rep.html"}}{\fldrslt \cf5 \strokec5 rep}}, stepmax, err.fct, \
        act.fct)\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/utils/data.html"}}{\fldrslt \cf5 \strokec5 data}} \cf6 \strokec6 <-\cf4 \strokec4  result\cf6 \strokec6 ${\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/utils/data.html"}}{\fldrslt \cf5 \strokec5 data}}\cf4 \strokec4 \
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/formula.html"}}{\fldrslt \cf5 \strokec5 formula}} \cf6 \strokec6 <-\cf4 \strokec4  result\cf6 \strokec6 ${\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/formula.html"}}{\fldrslt \cf5 \strokec5 formula}}\cf4 \strokec4 \
    startweights \cf6 \strokec6 <-\cf4 \strokec4  result\cf6 \strokec6 $\cf4 \strokec4 startweights\
    learningrate.limit \cf6 \strokec6 <-\cf4 \strokec4  result\cf6 \strokec6 $\cf4 \strokec4 learningrate.limit\
    learningrate.factor \cf6 \strokec6 <-\cf4 \strokec4  result\cf6 \strokec6 $\cf4 \strokec4 learningrate.factor\
    learningrate.bp \cf6 \strokec6 <-\cf4 \strokec4  result\cf6 \strokec6 $\cf4 \strokec4 learningrate.bp\
    lifesign \cf6 \strokec6 <-\cf4 \strokec4  result\cf6 \strokec6 $\cf4 \strokec4 lifesign\
    algorithm \cf6 \strokec6 <-\cf4 \strokec4  result\cf6 \strokec6 $\cf4 \strokec4 algorithm\
    threshold \cf6 \strokec6 <-\cf4 \strokec4  result\cf6 \strokec6 $\cf4 \strokec4 threshold\
    lifesign.step \cf6 \strokec6 <-\cf4 \strokec4  result\cf6 \strokec6 $\cf4 \strokec4 lifesign.step\
    hidden \cf6 \strokec6 <-\cf4 \strokec4  result\cf6 \strokec6 $\cf4 \strokec4 hidden\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/rep.html"}}{\fldrslt \cf5 \strokec5 rep}} \cf6 \strokec6 <-\cf4 \strokec4  result\cf6 \strokec6 ${\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/rep.html"}}{\fldrslt \cf5 \strokec5 rep}}\cf4 \strokec4 \
    stepmax \cf6 \strokec6 <-\cf4 \strokec4  result\cf6 \strokec6 $\cf4 \strokec4 stepmax\
    model.list \cf6 \strokec6 <-\cf4 \strokec4  result\cf6 \strokec6 $\cf4 \strokec4 model.list\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/matrix.html"}}{\fldrslt \cf5 \strokec5 matrix}} \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/NULL.html"}}{\fldrslt \cf5 \strokec5 NULL}}\
    list.result \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/NULL.html"}}{\fldrslt \cf5 \strokec5 NULL}}\
    result \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/cran/neuralnet/src/R/neuralnet.r"}}{\fldrslt \cf5 \strokec5 generate.initial.variables}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/utils/data.html"}}{\fldrslt \cf5 \strokec5 data}}, model.list, hidden, \
        act.fct, err.fct, algorithm, linear.output, {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/formula.html"}}{\fldrslt \cf5 \strokec5 formula}})\
    covariate \cf6 \strokec6 <-\cf4 \strokec4  result\cf6 \strokec6 $\cf4 \strokec4 covariate\
    response \cf6 \strokec6 <-\cf4 \strokec4  result\cf6 \strokec6 $\cf4 \strokec4 response\
    err.fct \cf6 \strokec6 <-\cf4 \strokec4  result\cf6 \strokec6 $\cf4 \strokec4 err.fct\
    err.deriv.fct \cf6 \strokec6 <-\cf4 \strokec4  result\cf6 \strokec6 $\cf4 \strokec4 err.deriv.fct\
    act.fct \cf6 \strokec6 <-\cf4 \strokec4  result\cf6 \strokec6 $\cf4 \strokec4 act.fct\
    act.deriv.fct \cf6 \strokec6 <-\cf4 \strokec4  result\cf6 \strokec6 $\cf4 \strokec4 act.deriv.fct\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 for}} (i {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 in}} \cf6 \strokec6 1:{\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/rep.html"}}{\fldrslt \cf5 \strokec5 rep}}\cf4 \strokec4 ) \{\
        {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} (lifesign \cf6 \strokec6 !=\cf4 \strokec4  \cf7 \strokec7 "none"\cf4 \strokec4 ) \{\
            lifesign \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/cran/neuralnet/src/R/neuralnet.r"}}{\fldrslt \cf5 \strokec5 display}}(hidden, threshold, {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/rep.html"}}{\fldrslt \cf5 \strokec5 rep}}, i, lifesign)\
        \}\
        {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/utils/utils-package.html"}}{\fldrslt \cf5 \strokec5 utils}}\cf6 \strokec6 ::{\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/utils/flush.console.html"}}{\fldrslt \cf5 \strokec5 flush.console}}\cf4 \strokec4 ()\
        result \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/cran/neuralnet/src/R/neuralnet.r"}}{\fldrslt \cf5 \strokec5 calculate.neuralnet}}(learningrate.limit \cf6 \strokec6 =\cf4 \strokec4  learningrate.limit, \
            learningrate.factor \cf6 \strokec6 =\cf4 \strokec4  learningrate.factor, covariate \cf6 \strokec6 =\cf4 \strokec4  covariate, \
            response \cf6 \strokec6 =\cf4 \strokec4  response, {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/utils/data.html"}}{\fldrslt \cf5 \strokec5 data}} \cf6 \strokec6 =\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/utils/data.html"}}{\fldrslt \cf5 \strokec5 data}}, model.list \cf6 \strokec6 =\cf4 \strokec4  model.list, \
            threshold \cf6 \strokec6 =\cf4 \strokec4  threshold, lifesign.step \cf6 \strokec6 =\cf4 \strokec4  lifesign.step, \
            stepmax \cf6 \strokec6 =\cf4 \strokec4  stepmax, hidden \cf6 \strokec6 =\cf4 \strokec4  hidden, lifesign \cf6 \strokec6 =\cf4 \strokec4  lifesign, \
            startweights \cf6 \strokec6 =\cf4 \strokec4  startweights, algorithm \cf6 \strokec6 =\cf4 \strokec4  algorithm, \
            err.fct \cf6 \strokec6 =\cf4 \strokec4  err.fct, err.deriv.fct \cf6 \strokec6 =\cf4 \strokec4  err.deriv.fct, \
            act.fct \cf6 \strokec6 =\cf4 \strokec4  act.fct, act.deriv.fct \cf6 \strokec6 =\cf4 \strokec4  act.deriv.fct, \
            {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/rep.html"}}{\fldrslt \cf5 \strokec5 rep}} \cf6 \strokec6 =\cf4 \strokec4  i, linear.output \cf6 \strokec6 =\cf4 \strokec4  linear.output, exclude \cf6 \strokec6 =\cf4 \strokec4  exclude, \
            constant.weights \cf6 \strokec6 =\cf4 \strokec4  constant.weights, likelihood \cf6 \strokec6 =\cf4 \strokec4  likelihood, \
            learningrate.bp \cf6 \strokec6 =\cf4 \strokec4  learningrate.bp)\
        {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} (\cf6 \strokec6 !{\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/NULL.html"}}{\fldrslt \cf5 \strokec5 is.null}}\cf4 \strokec4 (result\cf6 \strokec6 $\cf4 \strokec4 output.vector)) \{\
            list.result \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/c.html"}}{\fldrslt \cf5 \strokec5 c}}(list.result, {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/list.html"}}{\fldrslt \cf5 \strokec5 list}}(result))\
            {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/matrix.html"}}{\fldrslt \cf5 \strokec5 matrix}} \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/cbind.html"}}{\fldrslt \cf5 \strokec5 cbind}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/matrix.html"}}{\fldrslt \cf5 \strokec5 matrix}}, result\cf6 \strokec6 $\cf4 \strokec4 output.vector)\
        \}\
    \}\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/utils/utils-package.html"}}{\fldrslt \cf5 \strokec5 utils}}\cf6 \strokec6 ::{\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/utils/flush.console.html"}}{\fldrslt \cf5 \strokec5 flush.console}}\cf4 \strokec4 ()\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} (\cf6 \strokec6 !{\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/NULL.html"}}{\fldrslt \cf5 \strokec5 is.null}}\cf4 \strokec4 ({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/matrix.html"}}{\fldrslt \cf5 \strokec5 matrix}})) \{\
        weight.count \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/length.html"}}{\fldrslt \cf5 \strokec5 length}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/unlist.html"}}{\fldrslt \cf5 \strokec5 unlist}}(list.result[[\cf6 \strokec6 1\cf4 \strokec4 ]]\cf6 \strokec6 ${\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/weights.html"}}{\fldrslt \cf5 \strokec5 weights}}\cf4 \strokec4 )) \cf6 \strokec6 -\cf4 \strokec4  \
            {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/length.html"}}{\fldrslt \cf5 \strokec5 length}}(exclude) \cf6 \strokec6 +\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/length.html"}}{\fldrslt \cf5 \strokec5 length}}(constant.weights) \cf6 \strokec6 -\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/sum.html"}}{\fldrslt \cf5 \strokec5 sum}}(constant.weights \cf6 \strokec6 ==\cf4 \strokec4  \
            \cf6 \strokec6 0\cf4 \strokec4 )\
        {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} (\cf6 \strokec6 !{\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/NULL.html"}}{\fldrslt \cf5 \strokec5 is.null}}\cf4 \strokec4 (startweights) \cf6 \strokec6 &&\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/length.html"}}{\fldrslt \cf5 \strokec5 length}}(startweights) \cf6 \strokec6 <\cf4 \strokec4  \
            ({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/rep.html"}}{\fldrslt \cf5 \strokec5 rep}} \cf6 \strokec6 *\cf4 \strokec4  weight.count)) \{\
            {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/warning.html"}}{\fldrslt \cf5 \strokec5 warning}}(\cf7 \strokec7 "some weights were randomly generated, because 'startweights' did not contain enough values"\cf4 \strokec4 , \
                call. \cf6 \strokec6 =\cf4 \strokec4  \cf8 \strokec8 F\cf4 \strokec4 )\
        \}\
        ncol.matrix \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/nrow.html"}}{\fldrslt \cf5 \strokec5 ncol}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/matrix.html"}}{\fldrslt \cf5 \strokec5 matrix}})\
    \}\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 else}} ncol.matrix \cf6 \strokec6 <-\cf4 \strokec4  \cf6 \strokec6 0\cf4 \strokec4 \
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} (ncol.matrix \cf6 \strokec6 <\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/rep.html"}}{\fldrslt \cf5 \strokec5 rep}}) \
        {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/warning.html"}}{\fldrslt \cf5 \strokec5 warning}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/sprintf.html"}}{\fldrslt \cf5 \strokec5 sprintf}}(\cf7 \strokec7 "algorithm did not converge in %s of %s repetition(s) within the stepmax"\cf4 \strokec4 , \
            ({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/rep.html"}}{\fldrslt \cf5 \strokec5 rep}} \cf6 \strokec6 -\cf4 \strokec4  ncol.matrix), {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/rep.html"}}{\fldrslt \cf5 \strokec5 rep}}), call. \cf6 \strokec6 =\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/logical.html"}}{\fldrslt \cf5 \strokec5 FALSE}})\
    nn \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/cran/neuralnet/src/R/neuralnet.r"}}{\fldrslt \cf5 \strokec5 generate.output}}(covariate, {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/call.html"}}{\fldrslt \cf5 \strokec5 call}}, {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/rep.html"}}{\fldrslt \cf5 \strokec5 rep}}, threshold, {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/matrix.html"}}{\fldrslt \cf5 \strokec5 matrix}}, \
        startweights, model.list, response, err.fct, act.fct, \
        {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/utils/data.html"}}{\fldrslt \cf5 \strokec5 data}}, list.result, linear.output, exclude)\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/function.html"}}{\fldrslt \cf5 \strokec5 return}}(nn)\
\}\
\
\pard\pardeftab720\sl340\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://rdrr.io/cran/neuralnet/src/R/neuralnet.r"}}{\fldrslt \cf5 \strokec5 varify.variables}} \cf6 \strokec6 <-\cf4 \strokec4 \
\pard\pardeftab720\sl340\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/function.html"}}{\fldrslt \cf5 \strokec5 function}} ({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/utils/data.html"}}{\fldrslt \cf5 \strokec5 data}}, {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/formula.html"}}{\fldrslt \cf5 \strokec5 formula}}, startweights, learningrate.limit, learningrate.factor, \
    learningrate.bp, lifesign, algorithm, threshold, lifesign.step, \
    hidden, {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/rep.html"}}{\fldrslt \cf5 \strokec5 rep}}, stepmax, err.fct, act.fct) \
\{\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} ({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/NULL.html"}}{\fldrslt \cf5 \strokec5 is.null}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/utils/data.html"}}{\fldrslt \cf5 \strokec5 data}})) \
        {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/stop.html"}}{\fldrslt \cf5 \strokec5 stop}}(\cf7 \strokec7 "'data' is missing"\cf4 \strokec4 , call. \cf6 \strokec6 =\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/logical.html"}}{\fldrslt \cf5 \strokec5 FALSE}})\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} ({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/NULL.html"}}{\fldrslt \cf5 \strokec5 is.null}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/formula.html"}}{\fldrslt \cf5 \strokec5 formula}})) \
        {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/stop.html"}}{\fldrslt \cf5 \strokec5 stop}}(\cf7 \strokec7 "'formula' is missing"\cf4 \strokec4 , call. \cf6 \strokec6 =\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/logical.html"}}{\fldrslt \cf5 \strokec5 FALSE}})\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} (\cf6 \strokec6 !{\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/NULL.html"}}{\fldrslt \cf5 \strokec5 is.null}}\cf4 \strokec4 (startweights)) \{\
        startweights \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/vector.html"}}{\fldrslt \cf5 \strokec5 as.vector}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/unlist.html"}}{\fldrslt \cf5 \strokec5 unlist}}(startweights))\
        {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} ({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/any.html"}}{\fldrslt \cf5 \strokec5 any}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/NA.html"}}{\fldrslt \cf5 \strokec5 is.na}}(startweights))) \
            startweights \cf6 \strokec6 <-\cf4 \strokec4  startweights[\cf6 \strokec6 !{\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/NA.html"}}{\fldrslt \cf5 \strokec5 is.na}}\cf4 \strokec4 (startweights)]\
    \}\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/utils/data.html"}}{\fldrslt \cf5 \strokec5 data}} \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/as.data.frame.html"}}{\fldrslt \cf5 \strokec5 as.data.frame}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/utils/data.html"}}{\fldrslt \cf5 \strokec5 data}})\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/formula.html"}}{\fldrslt \cf5 \strokec5 formula}} \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/stats-package.html"}}{\fldrslt \cf5 \strokec5 stats}}\cf6 \strokec6 ::{\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/formula.html"}}{\fldrslt \cf5 \strokec5 as.formula}}\cf4 \strokec4 ({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/formula.html"}}{\fldrslt \cf5 \strokec5 formula}})\
    model.vars \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/attr.html"}}{\fldrslt \cf5 \strokec5 attr}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/stats-package.html"}}{\fldrslt \cf5 \strokec5 stats}}\cf6 \strokec6 ::{\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/terms.html"}}{\fldrslt \cf5 \strokec5 terms}}\cf4 \strokec4 ({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/formula.html"}}{\fldrslt \cf5 \strokec5 formula}}), \cf7 \strokec7 "term.labels"\cf4 \strokec4 )\
    formula.reverse \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/formula.html"}}{\fldrslt \cf5 \strokec5 formula}}\
    formula.reverse[[\cf6 \strokec6 3\cf4 \strokec4 ]] \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/formula.html"}}{\fldrslt \cf5 \strokec5 formula}}[[\cf6 \strokec6 2\cf4 \strokec4 ]]\
    model.resp \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/attr.html"}}{\fldrslt \cf5 \strokec5 attr}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/stats-package.html"}}{\fldrslt \cf5 \strokec5 stats}}\cf6 \strokec6 ::{\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/terms.html"}}{\fldrslt \cf5 \strokec5 terms}}\cf4 \strokec4 (formula.reverse), \cf7 \strokec7 "term.labels"\cf4 \strokec4 )\
    model.list \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/list.html"}}{\fldrslt \cf5 \strokec5 list}}(response \cf6 \strokec6 =\cf4 \strokec4  model.resp, variables \cf6 \strokec6 =\cf4 \strokec4  model.vars)\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} (\cf6 \strokec6 !{\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/NULL.html"}}{\fldrslt \cf5 \strokec5 is.null}}\cf4 \strokec4 (learningrate.limit)) \{\
        {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} ({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/length.html"}}{\fldrslt \cf5 \strokec5 length}}(learningrate.limit) \cf6 \strokec6 !=\cf4 \strokec4  \cf6 \strokec6 2\cf4 \strokec4 ) \
            {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/stop.html"}}{\fldrslt \cf5 \strokec5 stop}}(\cf7 \strokec7 "'learningrate.factor' must consist of two components"\cf4 \strokec4 , \
                call. \cf6 \strokec6 =\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/logical.html"}}{\fldrslt \cf5 \strokec5 FALSE}})\
        learningrate.limit \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/list.html"}}{\fldrslt \cf5 \strokec5 as.list}}(learningrate.limit)\
        {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/names.html"}}{\fldrslt \cf5 \strokec5 names}}(learningrate.limit) \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/c.html"}}{\fldrslt \cf5 \strokec5 c}}(\cf7 \strokec7 "min"\cf4 \strokec4 , \cf7 \strokec7 "max"\cf4 \strokec4 )\
        learningrate.limit\cf6 \strokec6 ${\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Extremes.html"}}{\fldrslt \cf5 \strokec5 min}}\cf4 \strokec4  \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/vector.html"}}{\fldrslt \cf5 \strokec5 as.vector}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/numeric.html"}}{\fldrslt \cf5 \strokec5 as.numeric}}(learningrate.limit\cf6 \strokec6 ${\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Extremes.html"}}{\fldrslt \cf5 \strokec5 min}}\cf4 \strokec4 ))\
        learningrate.limit\cf6 \strokec6 ${\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Extremes.html"}}{\fldrslt \cf5 \strokec5 max}}\cf4 \strokec4  \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/vector.html"}}{\fldrslt \cf5 \strokec5 as.vector}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/numeric.html"}}{\fldrslt \cf5 \strokec5 as.numeric}}(learningrate.limit\cf6 \strokec6 ${\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Extremes.html"}}{\fldrslt \cf5 \strokec5 max}}\cf4 \strokec4 ))\
        {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} ({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/NA.html"}}{\fldrslt \cf5 \strokec5 is.na}}(learningrate.limit\cf6 \strokec6 ${\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Extremes.html"}}{\fldrslt \cf5 \strokec5 min}}\cf4 \strokec4 ) \cf6 \strokec6 ||\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/NA.html"}}{\fldrslt \cf5 \strokec5 is.na}}(learningrate.limit\cf6 \strokec6 ${\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Extremes.html"}}{\fldrslt \cf5 \strokec5 max}}\cf4 \strokec4 )) \
            {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/stop.html"}}{\fldrslt \cf5 \strokec5 stop}}(\cf7 \strokec7 "'learningrate.limit' must be a numeric vector"\cf4 \strokec4 , \
                call. \cf6 \strokec6 =\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/logical.html"}}{\fldrslt \cf5 \strokec5 FALSE}})\
    \}\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} (\cf6 \strokec6 !{\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/NULL.html"}}{\fldrslt \cf5 \strokec5 is.null}}\cf4 \strokec4 (learningrate.factor)) \{\
        {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} ({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/length.html"}}{\fldrslt \cf5 \strokec5 length}}(learningrate.factor) \cf6 \strokec6 !=\cf4 \strokec4  \cf6 \strokec6 2\cf4 \strokec4 ) \
            {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/stop.html"}}{\fldrslt \cf5 \strokec5 stop}}(\cf7 \strokec7 "'learningrate.factor' must consist of two components"\cf4 \strokec4 , \
                call. \cf6 \strokec6 =\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/logical.html"}}{\fldrslt \cf5 \strokec5 FALSE}})\
        learningrate.factor \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/list.html"}}{\fldrslt \cf5 \strokec5 as.list}}(learningrate.factor)\
        {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/names.html"}}{\fldrslt \cf5 \strokec5 names}}(learningrate.factor) \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/c.html"}}{\fldrslt \cf5 \strokec5 c}}(\cf7 \strokec7 "minus"\cf4 \strokec4 , \cf7 \strokec7 "plus"\cf4 \strokec4 )\
        learningrate.factor\cf6 \strokec6 ${\field{\*\fldinst{HYPERLINK "https://rdrr.io/cran/neuralnet/src/R/neuralnet.r"}}{\fldrslt \cf5 \strokec5 minus}}\cf4 \strokec4  \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/vector.html"}}{\fldrslt \cf5 \strokec5 as.vector}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/numeric.html"}}{\fldrslt \cf5 \strokec5 as.numeric}}(learningrate.factor\cf6 \strokec6 ${\field{\*\fldinst{HYPERLINK "https://rdrr.io/cran/neuralnet/src/R/neuralnet.r"}}{\fldrslt \cf5 \strokec5 minus}}\cf4 \strokec4 ))\
        learningrate.factor\cf6 \strokec6 ${\field{\*\fldinst{HYPERLINK "https://rdrr.io/cran/neuralnet/src/R/neuralnet.r"}}{\fldrslt \cf5 \strokec5 plus}}\cf4 \strokec4  \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/vector.html"}}{\fldrslt \cf5 \strokec5 as.vector}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/numeric.html"}}{\fldrslt \cf5 \strokec5 as.numeric}}(learningrate.factor\cf6 \strokec6 ${\field{\*\fldinst{HYPERLINK "https://rdrr.io/cran/neuralnet/src/R/neuralnet.r"}}{\fldrslt \cf5 \strokec5 plus}}\cf4 \strokec4 ))\
        {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} ({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/NA.html"}}{\fldrslt \cf5 \strokec5 is.na}}(learningrate.factor\cf6 \strokec6 ${\field{\*\fldinst{HYPERLINK "https://rdrr.io/cran/neuralnet/src/R/neuralnet.r"}}{\fldrslt \cf5 \strokec5 minus}}\cf4 \strokec4 ) \cf6 \strokec6 ||\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/NA.html"}}{\fldrslt \cf5 \strokec5 is.na}}(learningrate.factor\cf6 \strokec6 ${\field{\*\fldinst{HYPERLINK "https://rdrr.io/cran/neuralnet/src/R/neuralnet.r"}}{\fldrslt \cf5 \strokec5 plus}}\cf4 \strokec4 )) \
            {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/stop.html"}}{\fldrslt \cf5 \strokec5 stop}}(\cf7 \strokec7 "'learningrate.factor' must be a numeric vector"\cf4 \strokec4 , \
                call. \cf6 \strokec6 =\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/logical.html"}}{\fldrslt \cf5 \strokec5 FALSE}})\
    \}\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 else}} learningrate.factor \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/list.html"}}{\fldrslt \cf5 \strokec5 list}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/cran/neuralnet/src/R/neuralnet.r"}}{\fldrslt \cf5 \strokec5 minus}} \cf6 \strokec6 =\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/c.html"}}{\fldrslt \cf5 \strokec5 c}}(\cf6 \strokec6 0.5\cf4 \strokec4 ), {\field{\*\fldinst{HYPERLINK "https://rdrr.io/cran/neuralnet/src/R/neuralnet.r"}}{\fldrslt \cf5 \strokec5 plus}} \cf6 \strokec6 =\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/c.html"}}{\fldrslt \cf5 \strokec5 c}}(\cf6 \strokec6 1.2\cf4 \strokec4 ))\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} ({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/NULL.html"}}{\fldrslt \cf5 \strokec5 is.null}}(lifesign)) \
        lifesign \cf6 \strokec6 <-\cf4 \strokec4  \cf7 \strokec7 "none"\cf4 \strokec4 \
    lifesign \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/character.html"}}{\fldrslt \cf5 \strokec5 as.character}}(lifesign)\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} (\cf6 \strokec6 !\cf4 \strokec4 ((lifesign \cf6 \strokec6 ==\cf4 \strokec4  \cf7 \strokec7 "none"\cf4 \strokec4 ) \cf6 \strokec6 ||\cf4 \strokec4  (lifesign \cf6 \strokec6 ==\cf4 \strokec4  \cf7 \strokec7 "minimal"\cf4 \strokec4 ) \cf6 \strokec6 ||\cf4 \strokec4  \
        (lifesign \cf6 \strokec6 ==\cf4 \strokec4  \cf7 \strokec7 "full"\cf4 \strokec4 ))) \
        lifesign \cf6 \strokec6 <-\cf4 \strokec4  \cf7 \strokec7 "minimal"\cf4 \strokec4 \
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} ({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/NA.html"}}{\fldrslt \cf5 \strokec5 is.na}}(lifesign)) \
        {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/stop.html"}}{\fldrslt \cf5 \strokec5 stop}}(\cf7 \strokec7 "'lifesign' must be a character"\cf4 \strokec4 , call. \cf6 \strokec6 =\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/logical.html"}}{\fldrslt \cf5 \strokec5 FALSE}})\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} ({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/NULL.html"}}{\fldrslt \cf5 \strokec5 is.null}}(algorithm)) \
        algorithm \cf6 \strokec6 <-\cf4 \strokec4  \cf7 \strokec7 "rprop+"\cf4 \strokec4 \
    algorithm \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/character.html"}}{\fldrslt \cf5 \strokec5 as.character}}(algorithm)\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} (\cf6 \strokec6 !\cf4 \strokec4 ((algorithm \cf6 \strokec6 ==\cf4 \strokec4  \cf7 \strokec7 "rprop+"\cf4 \strokec4 ) \cf6 \strokec6 ||\cf4 \strokec4  (algorithm \cf6 \strokec6 ==\cf4 \strokec4  \cf7 \strokec7 "rprop-"\cf4 \strokec4 ) \cf6 \strokec6 ||\cf4 \strokec4  \
        (algorithm \cf6 \strokec6 ==\cf4 \strokec4  \cf7 \strokec7 "slr"\cf4 \strokec4 ) \cf6 \strokec6 ||\cf4 \strokec4  (algorithm \cf6 \strokec6 ==\cf4 \strokec4  \cf7 \strokec7 "sag"\cf4 \strokec4 ) \cf6 \strokec6 ||\cf4 \strokec4  (algorithm \cf6 \strokec6 ==\cf4 \strokec4  \
        \cf7 \strokec7 "backprop"\cf4 \strokec4 ))) \
        {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/stop.html"}}{\fldrslt \cf5 \strokec5 stop}}(\cf7 \strokec7 "'algorithm' is not known"\cf4 \strokec4 , call. \cf6 \strokec6 =\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/logical.html"}}{\fldrslt \cf5 \strokec5 FALSE}})\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} ({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/NULL.html"}}{\fldrslt \cf5 \strokec5 is.null}}(threshold)) \
        threshold \cf6 \strokec6 <-\cf4 \strokec4  \cf6 \strokec6 0.01\cf4 \strokec4 \
    threshold \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/numeric.html"}}{\fldrslt \cf5 \strokec5 as.numeric}}(threshold)\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} ({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/NA.html"}}{\fldrslt \cf5 \strokec5 is.na}}(threshold)) \
        {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/stop.html"}}{\fldrslt \cf5 \strokec5 stop}}(\cf7 \strokec7 "'threshold' must be a numeric value"\cf4 \strokec4 , call. \cf6 \strokec6 =\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/logical.html"}}{\fldrslt \cf5 \strokec5 FALSE}})\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} (algorithm \cf6 \strokec6 ==\cf4 \strokec4  \cf7 \strokec7 "backprop"\cf4 \strokec4 ) \
        {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} ({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/NULL.html"}}{\fldrslt \cf5 \strokec5 is.null}}(learningrate.bp) \cf6 \strokec6 ||\cf4 \strokec4  \cf6 \strokec6 !{\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/numeric.html"}}{\fldrslt \cf5 \strokec5 is.numeric}}\cf4 \strokec4 (learningrate.bp)) \
            {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/stop.html"}}{\fldrslt \cf5 \strokec5 stop}}(\cf7 \strokec7 "'learningrate' must be a numeric value, if the backpropagation algorithm is used"\cf4 \strokec4 , \
                call. \cf6 \strokec6 =\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/logical.html"}}{\fldrslt \cf5 \strokec5 FALSE}})\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} ({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/NULL.html"}}{\fldrslt \cf5 \strokec5 is.null}}(lifesign.step)) \
        lifesign.step \cf6 \strokec6 <-\cf4 \strokec4  \cf6 \strokec6 1000\cf4 \strokec4 \
    lifesign.step \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/integer.html"}}{\fldrslt \cf5 \strokec5 as.integer}}(lifesign.step)\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} ({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/NA.html"}}{\fldrslt \cf5 \strokec5 is.na}}(lifesign.step)) \
        {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/stop.html"}}{\fldrslt \cf5 \strokec5 stop}}(\cf7 \strokec7 "'lifesign.step' must be an integer"\cf4 \strokec4 , call. \cf6 \strokec6 =\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/logical.html"}}{\fldrslt \cf5 \strokec5 FALSE}})\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} (lifesign.step \cf6 \strokec6 <\cf4 \strokec4  \cf6 \strokec6 1\cf4 \strokec4 ) \
        lifesign.step \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/integer.html"}}{\fldrslt \cf5 \strokec5 as.integer}}(\cf6 \strokec6 100\cf4 \strokec4 )\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} ({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/NULL.html"}}{\fldrslt \cf5 \strokec5 is.null}}(hidden)) \
        hidden \cf6 \strokec6 <-\cf4 \strokec4  \cf6 \strokec6 0\cf4 \strokec4 \
    hidden \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/vector.html"}}{\fldrslt \cf5 \strokec5 as.vector}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/integer.html"}}{\fldrslt \cf5 \strokec5 as.integer}}(hidden))\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} ({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/prod.html"}}{\fldrslt \cf5 \strokec5 prod}}(\cf6 \strokec6 !{\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/NA.html"}}{\fldrslt \cf5 \strokec5 is.na}}\cf4 \strokec4 (hidden)) \cf6 \strokec6 ==\cf4 \strokec4  \cf6 \strokec6 0\cf4 \strokec4 ) \
        {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/stop.html"}}{\fldrslt \cf5 \strokec5 stop}}(\cf7 \strokec7 "'hidden' must be an integer vector or a single integer"\cf4 \strokec4 , \
            call. \cf6 \strokec6 =\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/logical.html"}}{\fldrslt \cf5 \strokec5 FALSE}})\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} ({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/length.html"}}{\fldrslt \cf5 \strokec5 length}}(hidden) \cf6 \strokec6 >\cf4 \strokec4  \cf6 \strokec6 1\cf4 \strokec4  \cf6 \strokec6 &&\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/prod.html"}}{\fldrslt \cf5 \strokec5 prod}}(hidden) \cf6 \strokec6 ==\cf4 \strokec4  \cf6 \strokec6 0\cf4 \strokec4 ) \
        {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/stop.html"}}{\fldrslt \cf5 \strokec5 stop}}(\cf7 \strokec7 "'hidden' contains at least one 0"\cf4 \strokec4 , call. \cf6 \strokec6 =\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/logical.html"}}{\fldrslt \cf5 \strokec5 FALSE}})\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} ({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/NULL.html"}}{\fldrslt \cf5 \strokec5 is.null}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/rep.html"}}{\fldrslt \cf5 \strokec5 rep}})) \
        {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/rep.html"}}{\fldrslt \cf5 \strokec5 rep}} \cf6 \strokec6 <-\cf4 \strokec4  \cf6 \strokec6 1\cf4 \strokec4 \
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/rep.html"}}{\fldrslt \cf5 \strokec5 rep}} \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/integer.html"}}{\fldrslt \cf5 \strokec5 as.integer}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/rep.html"}}{\fldrslt \cf5 \strokec5 rep}})\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} ({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/NA.html"}}{\fldrslt \cf5 \strokec5 is.na}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/rep.html"}}{\fldrslt \cf5 \strokec5 rep}})) \
        {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/stop.html"}}{\fldrslt \cf5 \strokec5 stop}}(\cf7 \strokec7 "'rep' must be an integer"\cf4 \strokec4 , call. \cf6 \strokec6 =\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/logical.html"}}{\fldrslt \cf5 \strokec5 FALSE}})\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} ({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/NULL.html"}}{\fldrslt \cf5 \strokec5 is.null}}(stepmax)) \
        stepmax \cf6 \strokec6 <-\cf4 \strokec4  \cf6 \strokec6 10000\cf4 \strokec4 \
    stepmax \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/integer.html"}}{\fldrslt \cf5 \strokec5 as.integer}}(stepmax)\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} ({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/NA.html"}}{\fldrslt \cf5 \strokec5 is.na}}(stepmax)) \
        {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/stop.html"}}{\fldrslt \cf5 \strokec5 stop}}(\cf7 \strokec7 "'stepmax' must be an integer"\cf4 \strokec4 , call. \cf6 \strokec6 =\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/logical.html"}}{\fldrslt \cf5 \strokec5 FALSE}})\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} (stepmax \cf6 \strokec6 <\cf4 \strokec4  \cf6 \strokec6 1\cf4 \strokec4 ) \
        stepmax \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/integer.html"}}{\fldrslt \cf5 \strokec5 as.integer}}(\cf6 \strokec6 1000\cf4 \strokec4 )\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} ({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/NULL.html"}}{\fldrslt \cf5 \strokec5 is.null}}(hidden)) \{\
        {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} ({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/NULL.html"}}{\fldrslt \cf5 \strokec5 is.null}}(learningrate.limit)) \
            learningrate.limit \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/list.html"}}{\fldrslt \cf5 \strokec5 list}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Extremes.html"}}{\fldrslt \cf5 \strokec5 min}} \cf6 \strokec6 =\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/c.html"}}{\fldrslt \cf5 \strokec5 c}}(\cf6 \strokec6 1e-08\cf4 \strokec4 ), {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Extremes.html"}}{\fldrslt \cf5 \strokec5 max}} \cf6 \strokec6 =\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/c.html"}}{\fldrslt \cf5 \strokec5 c}}(\cf6 \strokec6 50\cf4 \strokec4 ))\
    \}\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 else}} \{\
        {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} ({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/NULL.html"}}{\fldrslt \cf5 \strokec5 is.null}}(learningrate.limit)) \
            learningrate.limit \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/list.html"}}{\fldrslt \cf5 \strokec5 list}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Extremes.html"}}{\fldrslt \cf5 \strokec5 min}} \cf6 \strokec6 =\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/c.html"}}{\fldrslt \cf5 \strokec5 c}}(\cf6 \strokec6 1e-10\cf4 \strokec4 ), {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Extremes.html"}}{\fldrslt \cf5 \strokec5 max}} \cf6 \strokec6 =\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/c.html"}}{\fldrslt \cf5 \strokec5 c}}(\cf6 \strokec6 0.1\cf4 \strokec4 ))\
    \}\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} (\cf6 \strokec6 !{\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/is.function.html"}}{\fldrslt \cf5 \strokec5 is.function}}\cf4 \strokec4 (act.fct) \cf6 \strokec6 &&\cf4 \strokec4  act.fct \cf6 \strokec6 !=\cf4 \strokec4  \cf7 \strokec7 "logistic"\cf4 \strokec4  \cf6 \strokec6 &&\cf4 \strokec4  act.fct \cf6 \strokec6 !=\cf4 \strokec4  \
        \cf7 \strokec7 "tanh"\cf4 \strokec4 ) \
        {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/stop.html"}}{\fldrslt \cf5 \strokec5 stop}}(\cf7 \strokec7 "''act.fct' is not known"\cf4 \strokec4 , call. \cf6 \strokec6 =\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/logical.html"}}{\fldrslt \cf5 \strokec5 FALSE}})\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} (\cf6 \strokec6 !{\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/is.function.html"}}{\fldrslt \cf5 \strokec5 is.function}}\cf4 \strokec4 (err.fct) \cf6 \strokec6 &&\cf4 \strokec4  err.fct \cf6 \strokec6 !=\cf4 \strokec4  \cf7 \strokec7 "sse"\cf4 \strokec4  \cf6 \strokec6 &&\cf4 \strokec4  err.fct \cf6 \strokec6 !=\cf4 \strokec4  \
        \cf7 \strokec7 "ce"\cf4 \strokec4 ) \
        {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/stop.html"}}{\fldrslt \cf5 \strokec5 stop}}(\cf7 \strokec7 "'err.fct' is not known"\cf4 \strokec4 , call. \cf6 \strokec6 =\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/logical.html"}}{\fldrslt \cf5 \strokec5 FALSE}})\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/function.html"}}{\fldrslt \cf5 \strokec5 return}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/list.html"}}{\fldrslt \cf5 \strokec5 list}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/utils/data.html"}}{\fldrslt \cf5 \strokec5 data}} \cf6 \strokec6 =\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/utils/data.html"}}{\fldrslt \cf5 \strokec5 data}}, {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/formula.html"}}{\fldrslt \cf5 \strokec5 formula}} \cf6 \strokec6 =\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/formula.html"}}{\fldrslt \cf5 \strokec5 formula}}, startweights \cf6 \strokec6 =\cf4 \strokec4  startweights, \
        learningrate.limit \cf6 \strokec6 =\cf4 \strokec4  learningrate.limit, learningrate.factor \cf6 \strokec6 =\cf4 \strokec4  learningrate.factor, \
        learningrate.bp \cf6 \strokec6 =\cf4 \strokec4  learningrate.bp, lifesign \cf6 \strokec6 =\cf4 \strokec4  lifesign, \
        algorithm \cf6 \strokec6 =\cf4 \strokec4  algorithm, threshold \cf6 \strokec6 =\cf4 \strokec4  threshold, lifesign.step \cf6 \strokec6 =\cf4 \strokec4  lifesign.step, \
        hidden \cf6 \strokec6 =\cf4 \strokec4  hidden, {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/rep.html"}}{\fldrslt \cf5 \strokec5 rep}} \cf6 \strokec6 =\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/rep.html"}}{\fldrslt \cf5 \strokec5 rep}}, stepmax \cf6 \strokec6 =\cf4 \strokec4  stepmax, model.list \cf6 \strokec6 =\cf4 \strokec4  model.list))\
\}\
\
\pard\pardeftab720\sl340\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://rdrr.io/cran/neuralnet/src/R/neuralnet.r"}}{\fldrslt \cf5 \strokec5 generate.initial.variables}} \cf6 \strokec6 <-\cf4 \strokec4 \
\pard\pardeftab720\sl340\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/function.html"}}{\fldrslt \cf5 \strokec5 function}} ({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/utils/data.html"}}{\fldrslt \cf5 \strokec5 data}}, model.list, hidden, act.fct, err.fct, algorithm, \
    linear.output, {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/formula.html"}}{\fldrslt \cf5 \strokec5 formula}}) \
\{\
    formula.reverse \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/formula.html"}}{\fldrslt \cf5 \strokec5 formula}}\
    formula.reverse[[\cf6 \strokec6 2\cf4 \strokec4 ]] \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/stats-package.html"}}{\fldrslt \cf5 \strokec5 stats}}\cf6 \strokec6 ::{\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/formula.html"}}{\fldrslt \cf5 \strokec5 as.formula}}\cf4 \strokec4 ({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/paste.html"}}{\fldrslt \cf5 \strokec5 paste}}(model.list\cf6 \strokec6 $\cf4 \strokec4 response[[\cf6 \strokec6 1\cf4 \strokec4 ]], \
        \cf7 \strokec7 "~"\cf4 \strokec4 , model.list\cf6 \strokec6 $\cf4 \strokec4 variables[[\cf6 \strokec6 1\cf4 \strokec4 ]], sep \cf6 \strokec6 =\cf4 \strokec4  \cf7 \strokec7 ""\cf4 \strokec4 ))[[\cf6 \strokec6 2\cf4 \strokec4 ]]\
    formula.reverse[[\cf6 \strokec6 3\cf4 \strokec4 ]] \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/formula.html"}}{\fldrslt \cf5 \strokec5 formula}}[[\cf6 \strokec6 2\cf4 \strokec4 ]]\
    response \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/matrix.html"}}{\fldrslt \cf5 \strokec5 as.matrix}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/stats-package.html"}}{\fldrslt \cf5 \strokec5 stats}}\cf6 \strokec6 ::{\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/model.frame.html"}}{\fldrslt \cf5 \strokec5 model.frame}}\cf4 \strokec4 (formula.reverse, {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/utils/data.html"}}{\fldrslt \cf5 \strokec5 data}}))\
    formula.reverse[[\cf6 \strokec6 3\cf4 \strokec4 ]] \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/formula.html"}}{\fldrslt \cf5 \strokec5 formula}}[[\cf6 \strokec6 3\cf4 \strokec4 ]]\
    covariate \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/matrix.html"}}{\fldrslt \cf5 \strokec5 as.matrix}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/stats-package.html"}}{\fldrslt \cf5 \strokec5 stats}}\cf6 \strokec6 ::{\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/model.frame.html"}}{\fldrslt \cf5 \strokec5 model.frame}}\cf4 \strokec4 (formula.reverse, {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/utils/data.html"}}{\fldrslt \cf5 \strokec5 data}}))\
    covariate[, \cf6 \strokec6 1\cf4 \strokec4 ] \cf6 \strokec6 <-\cf4 \strokec4  \cf6 \strokec6 1\cf4 \strokec4 \
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/colnames.html"}}{\fldrslt \cf5 \strokec5 colnames}}(covariate)[\cf6 \strokec6 1\cf4 \strokec4 ] \cf6 \strokec6 <-\cf4 \strokec4  \cf7 \strokec7 "intercept"\cf4 \strokec4 \
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} ({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/is.function.html"}}{\fldrslt \cf5 \strokec5 is.function}}(act.fct)) \{\
        act.deriv.fct \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/cran/neuralnet/src/R/neuralnet.r"}}{\fldrslt \cf5 \strokec5 differentiate}}(act.fct)\
        {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/attr.html"}}{\fldrslt \cf5 \strokec5 attr}}(act.fct, \cf7 \strokec7 "type"\cf4 \strokec4 ) \cf6 \strokec6 <-\cf4 \strokec4  \cf7 \strokec7 "function"\cf4 \strokec4 \
    \}\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 else}} \{\
        {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} (act.fct \cf6 \strokec6 ==\cf4 \strokec4  \cf7 \strokec7 "tanh"\cf4 \strokec4 ) \{\
            act.fct \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/function.html"}}{\fldrslt \cf5 \strokec5 function}}(x) \{\
                {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Hyperbolic.html"}}{\fldrslt \cf5 \strokec5 tanh}}(x)\
            \}\
            {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/attr.html"}}{\fldrslt \cf5 \strokec5 attr}}(act.fct, \cf7 \strokec7 "type"\cf4 \strokec4 ) \cf6 \strokec6 <-\cf4 \strokec4  \cf7 \strokec7 "tanh"\cf4 \strokec4 \
            act.deriv.fct \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/function.html"}}{\fldrslt \cf5 \strokec5 function}}(x) \{\
                \cf6 \strokec6 1\cf4 \strokec4  \cf6 \strokec6 -\cf4 \strokec4  x\cf6 \strokec6 ^2\cf4 \strokec4 \
            \}\
        \}\
        {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 else}} {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} (act.fct \cf6 \strokec6 ==\cf4 \strokec4  \cf7 \strokec7 "logistic"\cf4 \strokec4 ) \{\
            act.fct \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/function.html"}}{\fldrslt \cf5 \strokec5 function}}(x) \{\
                \cf6 \strokec6 1/\cf4 \strokec4 (\cf6 \strokec6 1\cf4 \strokec4  \cf6 \strokec6 +\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Log.html"}}{\fldrslt \cf5 \strokec5 exp}}(\cf6 \strokec6 -\cf4 \strokec4 x))\
            \}\
            {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/attr.html"}}{\fldrslt \cf5 \strokec5 attr}}(act.fct, \cf7 \strokec7 "type"\cf4 \strokec4 ) \cf6 \strokec6 <-\cf4 \strokec4  \cf7 \strokec7 "logistic"\cf4 \strokec4 \
            act.deriv.fct \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/function.html"}}{\fldrslt \cf5 \strokec5 function}}(x) \{\
                x \cf6 \strokec6 *\cf4 \strokec4  (\cf6 \strokec6 1\cf4 \strokec4  \cf6 \strokec6 -\cf4 \strokec4  x)\
            \}\
        \}\
    \}\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} ({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/is.function.html"}}{\fldrslt \cf5 \strokec5 is.function}}(err.fct)) \{\
        err.deriv.fct \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/cran/neuralnet/src/R/neuralnet.r"}}{\fldrslt \cf5 \strokec5 differentiate}}(err.fct)\
        {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/attr.html"}}{\fldrslt \cf5 \strokec5 attr}}(err.fct, \cf7 \strokec7 "type"\cf4 \strokec4 ) \cf6 \strokec6 <-\cf4 \strokec4  \cf7 \strokec7 "function"\cf4 \strokec4 \
    \}\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 else}} \{\
        {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} (err.fct \cf6 \strokec6 ==\cf4 \strokec4  \cf7 \strokec7 "ce"\cf4 \strokec4 ) \{\
            {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} ({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/all.html"}}{\fldrslt \cf5 \strokec5 all}}(response \cf6 \strokec6 ==\cf4 \strokec4  \cf6 \strokec6 0\cf4 \strokec4  \cf6 \strokec6 |\cf4 \strokec4  response \cf6 \strokec6 ==\cf4 \strokec4  \cf6 \strokec6 1\cf4 \strokec4 )) \{\
                err.fct \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/function.html"}}{\fldrslt \cf5 \strokec5 function}}(x, y) \{\
                  \cf6 \strokec6 -\cf4 \strokec4 (y \cf6 \strokec6 *\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Log.html"}}{\fldrslt \cf5 \strokec5 log}}(x) \cf6 \strokec6 +\cf4 \strokec4  (\cf6 \strokec6 1\cf4 \strokec4  \cf6 \strokec6 -\cf4 \strokec4  y) \cf6 \strokec6 *\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Log.html"}}{\fldrslt \cf5 \strokec5 log}}(\cf6 \strokec6 1\cf4 \strokec4  \cf6 \strokec6 -\cf4 \strokec4  x))\
                \}\
                {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/attr.html"}}{\fldrslt \cf5 \strokec5 attr}}(err.fct, \cf7 \strokec7 "type"\cf4 \strokec4 ) \cf6 \strokec6 <-\cf4 \strokec4  \cf7 \strokec7 "ce"\cf4 \strokec4 \
                err.deriv.fct \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/function.html"}}{\fldrslt \cf5 \strokec5 function}}(x, y) \{\
                  (\cf6 \strokec6 1\cf4 \strokec4  \cf6 \strokec6 -\cf4 \strokec4  y)\cf6 \strokec6 /\cf4 \strokec4 (\cf6 \strokec6 1\cf4 \strokec4  \cf6 \strokec6 -\cf4 \strokec4  x) \cf6 \strokec6 -\cf4 \strokec4  y\cf6 \strokec6 /\cf4 \strokec4 x\
                \}\
            \}\
            {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 else}} \{\
                err.fct \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/function.html"}}{\fldrslt \cf5 \strokec5 function}}(x, y) \{\
                  \cf6 \strokec6 1/2\cf4 \strokec4  \cf6 \strokec6 *\cf4 \strokec4  (y \cf6 \strokec6 -\cf4 \strokec4  x)\cf6 \strokec6 ^2\cf4 \strokec4 \
                \}\
                {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/attr.html"}}{\fldrslt \cf5 \strokec5 attr}}(err.fct, \cf7 \strokec7 "type"\cf4 \strokec4 ) \cf6 \strokec6 <-\cf4 \strokec4  \cf7 \strokec7 "sse"\cf4 \strokec4 \
                err.deriv.fct \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/function.html"}}{\fldrslt \cf5 \strokec5 function}}(x, y) \{\
                  x \cf6 \strokec6 -\cf4 \strokec4  y\
                \}\
                {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/warning.html"}}{\fldrslt \cf5 \strokec5 warning}}(\cf7 \strokec7 "'err.fct' was automatically set to sum of squared error (sse), because the response is not binary"\cf4 \strokec4 , \
                  call. \cf6 \strokec6 =\cf4 \strokec4  \cf8 \strokec8 F\cf4 \strokec4 )\
            \}\
        \}\
        {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 else}} {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} (err.fct \cf6 \strokec6 ==\cf4 \strokec4  \cf7 \strokec7 "sse"\cf4 \strokec4 ) \{\
            err.fct \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/function.html"}}{\fldrslt \cf5 \strokec5 function}}(x, y) \{\
                \cf6 \strokec6 1/2\cf4 \strokec4  \cf6 \strokec6 *\cf4 \strokec4  (y \cf6 \strokec6 -\cf4 \strokec4  x)\cf6 \strokec6 ^2\cf4 \strokec4 \
            \}\
            {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/attr.html"}}{\fldrslt \cf5 \strokec5 attr}}(err.fct, \cf7 \strokec7 "type"\cf4 \strokec4 ) \cf6 \strokec6 <-\cf4 \strokec4  \cf7 \strokec7 "sse"\cf4 \strokec4 \
            err.deriv.fct \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/function.html"}}{\fldrslt \cf5 \strokec5 function}}(x, y) \{\
                x \cf6 \strokec6 -\cf4 \strokec4  y\
            \}\
        \}\
    \}\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/function.html"}}{\fldrslt \cf5 \strokec5 return}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/list.html"}}{\fldrslt \cf5 \strokec5 list}}(covariate \cf6 \strokec6 =\cf4 \strokec4  covariate, response \cf6 \strokec6 =\cf4 \strokec4  response, err.fct \cf6 \strokec6 =\cf4 \strokec4  err.fct, \
        err.deriv.fct \cf6 \strokec6 =\cf4 \strokec4  err.deriv.fct, act.fct \cf6 \strokec6 =\cf4 \strokec4  act.fct, act.deriv.fct \cf6 \strokec6 =\cf4 \strokec4  act.deriv.fct))\
\}\
\pard\pardeftab720\sl340\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://rdrr.io/cran/neuralnet/src/R/neuralnet.r"}}{\fldrslt \cf5 \strokec5 differentiate}} \cf6 \strokec6 <-\cf4 \strokec4 \
\pard\pardeftab720\sl340\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/function.html"}}{\fldrslt \cf5 \strokec5 function}} (orig.fct, hessian \cf6 \strokec6 =\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/logical.html"}}{\fldrslt \cf5 \strokec5 FALSE}}) \
\{\
    body.fct \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/deparse.html"}}{\fldrslt \cf5 \strokec5 deparse}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/body.html"}}{\fldrslt \cf5 \strokec5 body}}(orig.fct))\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} (body.fct[\cf6 \strokec6 1\cf4 \strokec4 ] \cf6 \strokec6 ==\cf4 \strokec4  \cf7 \strokec7 "\{"\cf4 \strokec4 ) \
        body.fct \cf6 \strokec6 <-\cf4 \strokec4  body.fct[\cf6 \strokec6 2\cf4 \strokec4 ]\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/graphics/text.html"}}{\fldrslt \cf5 \strokec5 text}} \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/paste.html"}}{\fldrslt \cf5 \strokec5 paste}}(\cf7 \strokec7 "y~"\cf4 \strokec4 , body.fct, sep \cf6 \strokec6 =\cf4 \strokec4  \cf7 \strokec7 ""\cf4 \strokec4 )\
    text2 \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/paste.html"}}{\fldrslt \cf5 \strokec5 paste}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/deparse.html"}}{\fldrslt \cf5 \strokec5 deparse}}(orig.fct)[\cf6 \strokec6 1\cf4 \strokec4 ], \cf7 \strokec7 "\{\}"\cf4 \strokec4 )\
    temp \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/stats-package.html"}}{\fldrslt \cf5 \strokec5 stats}}\cf6 \strokec6 ::{\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/deriv.html"}}{\fldrslt \cf5 \strokec5 deriv}}\cf4 \strokec4 ({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/eval.html"}}{\fldrslt \cf5 \strokec5 eval}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/parse.html"}}{\fldrslt \cf5 \strokec5 parse}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/graphics/text.html"}}{\fldrslt \cf5 \strokec5 text}} \cf6 \strokec6 =\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/graphics/text.html"}}{\fldrslt \cf5 \strokec5 text}})), \cf7 \strokec7 "x"\cf4 \strokec4 , func \cf6 \strokec6 =\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/eval.html"}}{\fldrslt \cf5 \strokec5 eval}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/parse.html"}}{\fldrslt \cf5 \strokec5 parse}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/graphics/text.html"}}{\fldrslt \cf5 \strokec5 text}} \cf6 \strokec6 =\cf4 \strokec4  text2)), \
        hessian \cf6 \strokec6 =\cf4 \strokec4  hessian)\
    temp \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/deparse.html"}}{\fldrslt \cf5 \strokec5 deparse}}(temp)\
    derivative \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/NULL.html"}}{\fldrslt \cf5 \strokec5 NULL}}\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} (\cf6 \strokec6 !\cf4 \strokec4 hessian) \
        {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 for}} (i {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 in}} \cf6 \strokec6 1:{\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/length.html"}}{\fldrslt \cf5 \strokec5 length}}\cf4 \strokec4 (temp)) \{\
            {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} (\cf6 \strokec6 !{\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/any.html"}}{\fldrslt \cf5 \strokec5 any}}\cf4 \strokec4 ({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/grep.html"}}{\fldrslt \cf5 \strokec5 grep}}(\cf7 \strokec7 "value"\cf4 \strokec4 , temp[i]))) \
                derivative \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/c.html"}}{\fldrslt \cf5 \strokec5 c}}(derivative, temp[i])\
        \}\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 else}} {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 for}} (i {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 in}} \cf6 \strokec6 1:{\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/length.html"}}{\fldrslt \cf5 \strokec5 length}}\cf4 \strokec4 (temp)) \{\
        {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} (\cf6 \strokec6 !{\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/any.html"}}{\fldrslt \cf5 \strokec5 any}}\cf4 \strokec4 ({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/grep.html"}}{\fldrslt \cf5 \strokec5 grep}}(\cf7 \strokec7 "value"\cf4 \strokec4 , temp[i]), {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/grep.html"}}{\fldrslt \cf5 \strokec5 grep}}(\cf7 \strokec7 "grad"\cf4 \strokec4 , temp[i]), \
            {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/grep.html"}}{\fldrslt \cf5 \strokec5 grep}}(\cf7 \strokec7 ", c"\cf4 \strokec4 , temp[i]))) \
            derivative \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/c.html"}}{\fldrslt \cf5 \strokec5 c}}(derivative, temp[i])\
    \}\
    number \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/NULL.html"}}{\fldrslt \cf5 \strokec5 NULL}}\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 for}} (i {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 in}} \cf6 \strokec6 1:{\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/length.html"}}{\fldrslt \cf5 \strokec5 length}}\cf4 \strokec4 (derivative)) \{\
        {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} ({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/any.html"}}{\fldrslt \cf5 \strokec5 any}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/grep.html"}}{\fldrslt \cf5 \strokec5 grep}}(\cf7 \strokec7 "<-"\cf4 \strokec4 , derivative[i]))) \
            number \cf6 \strokec6 <-\cf4 \strokec4  i\
    \}\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} ({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/NULL.html"}}{\fldrslt \cf5 \strokec5 is.null}}(number)) \{\
        {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/function.html"}}{\fldrslt \cf5 \strokec5 return}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/function.html"}}{\fldrslt \cf5 \strokec5 function}}(x) \{\
            {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/matrix.html"}}{\fldrslt \cf5 \strokec5 matrix}}(\cf6 \strokec6 0\cf4 \strokec4 , {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/nrow.html"}}{\fldrslt \cf5 \strokec5 nrow}}(x), {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/nrow.html"}}{\fldrslt \cf5 \strokec5 ncol}}(x))\
        \})\
    \}\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 else}} \{\
        derivative[number] \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/unlist.html"}}{\fldrslt \cf5 \strokec5 unlist}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/strsplit.html"}}{\fldrslt \cf5 \strokec5 strsplit}}(derivative[number], \
            \cf7 \strokec7 "<-"\cf4 \strokec4 ))[\cf6 \strokec6 2\cf4 \strokec4 ]\
        derivative \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/eval.html"}}{\fldrslt \cf5 \strokec5 eval}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/parse.html"}}{\fldrslt \cf5 \strokec5 parse}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/graphics/text.html"}}{\fldrslt \cf5 \strokec5 text}} \cf6 \strokec6 =\cf4 \strokec4  derivative))\
    \}\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} ({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/length.html"}}{\fldrslt \cf5 \strokec5 length}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/formals.html"}}{\fldrslt \cf5 \strokec5 formals}}(derivative)) \cf6 \strokec6 ==\cf4 \strokec4  \cf6 \strokec6 1\cf4 \strokec4  \cf6 \strokec6 &&\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/length.html"}}{\fldrslt \cf5 \strokec5 length}}(derivative({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/c.html"}}{\fldrslt \cf5 \strokec5 c}}(\cf6 \strokec6 1\cf4 \strokec4 , \
        \cf6 \strokec6 1\cf4 \strokec4 ))) \cf6 \strokec6 ==\cf4 \strokec4  \cf6 \strokec6 1\cf4 \strokec4 ) \
        derivative \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/eval.html"}}{\fldrslt \cf5 \strokec5 eval}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/parse.html"}}{\fldrslt \cf5 \strokec5 parse}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/graphics/text.html"}}{\fldrslt \cf5 \strokec5 text}} \cf6 \strokec6 =\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/paste.html"}}{\fldrslt \cf5 \strokec5 paste}}(\cf7 \strokec7 "function(x)\{matrix("\cf4 \strokec4 , \
            derivative(\cf6 \strokec6 1\cf4 \strokec4 ), \cf7 \strokec7 ", nrow(x), ncol(x))\}"\cf4 \strokec4 )))\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} ({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/length.html"}}{\fldrslt \cf5 \strokec5 length}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/formals.html"}}{\fldrslt \cf5 \strokec5 formals}}(derivative)) \cf6 \strokec6 ==\cf4 \strokec4  \cf6 \strokec6 2\cf4 \strokec4  \cf6 \strokec6 &&\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/length.html"}}{\fldrslt \cf5 \strokec5 length}}(derivative({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/c.html"}}{\fldrslt \cf5 \strokec5 c}}(\cf6 \strokec6 1\cf4 \strokec4 , \
        \cf6 \strokec6 1\cf4 \strokec4 ), {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/c.html"}}{\fldrslt \cf5 \strokec5 c}}(\cf6 \strokec6 1\cf4 \strokec4 , \cf6 \strokec6 1\cf4 \strokec4 ))) \cf6 \strokec6 ==\cf4 \strokec4  \cf6 \strokec6 1\cf4 \strokec4 ) \
        derivative \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/eval.html"}}{\fldrslt \cf5 \strokec5 eval}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/parse.html"}}{\fldrslt \cf5 \strokec5 parse}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/graphics/text.html"}}{\fldrslt \cf5 \strokec5 text}} \cf6 \strokec6 =\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/paste.html"}}{\fldrslt \cf5 \strokec5 paste}}(\cf7 \strokec7 "function(x, y)\{matrix("\cf4 \strokec4 , \
            derivative(\cf6 \strokec6 1\cf4 \strokec4 , \cf6 \strokec6 1\cf4 \strokec4 ), \cf7 \strokec7 ", nrow(x), ncol(x))\}"\cf4 \strokec4 )))\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/function.html"}}{\fldrslt \cf5 \strokec5 return}}(derivative)\
\}\
\pard\pardeftab720\sl340\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://rdrr.io/cran/neuralnet/src/R/neuralnet.r"}}{\fldrslt \cf5 \strokec5 display}} \cf6 \strokec6 <-\cf4 \strokec4 \
\pard\pardeftab720\sl340\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/function.html"}}{\fldrslt \cf5 \strokec5 function}} (hidden, threshold, {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/rep.html"}}{\fldrslt \cf5 \strokec5 rep}}, i.rep, lifesign) \
\{\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/graphics/text.html"}}{\fldrslt \cf5 \strokec5 text}} \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/paste.html"}}{\fldrslt \cf5 \strokec5 paste}}(\cf7 \strokec7 "    rep: %"\cf4 \strokec4 , {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/nchar.html"}}{\fldrslt \cf5 \strokec5 nchar}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/rep.html"}}{\fldrslt \cf5 \strokec5 rep}}) \cf6 \strokec6 -\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/nchar.html"}}{\fldrslt \cf5 \strokec5 nchar}}(i.rep), \cf7 \strokec7 "s"\cf4 \strokec4 , \
        sep \cf6 \strokec6 =\cf4 \strokec4  \cf7 \strokec7 ""\cf4 \strokec4 )\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/cat.html"}}{\fldrslt \cf5 \strokec5 cat}}(\cf7 \strokec7 "hidden: "\cf4 \strokec4 , {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/paste.html"}}{\fldrslt \cf5 \strokec5 paste}}(hidden, collapse \cf6 \strokec6 =\cf4 \strokec4  \cf7 \strokec7 ", "\cf4 \strokec4 ), \cf7 \strokec7 "    thresh: "\cf4 \strokec4 , \
        threshold, {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/sprintf.html"}}{\fldrslt \cf5 \strokec5 sprintf}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/eval.html"}}{\fldrslt \cf5 \strokec5 eval}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/expression.html"}}{\fldrslt \cf5 \strokec5 expression}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/graphics/text.html"}}{\fldrslt \cf5 \strokec5 text}})), \cf7 \strokec7 ""\cf4 \strokec4 ), i.rep, \
        \cf7 \strokec7 "/"\cf4 \strokec4 , {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/rep.html"}}{\fldrslt \cf5 \strokec5 rep}}, \cf7 \strokec7 "    steps: "\cf4 \strokec4 , sep \cf6 \strokec6 =\cf4 \strokec4  \cf7 \strokec7 ""\cf4 \strokec4 )\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} (lifesign \cf6 \strokec6 ==\cf4 \strokec4  \cf7 \strokec7 "full"\cf4 \strokec4 ) \
        lifesign \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/sum.html"}}{\fldrslt \cf5 \strokec5 sum}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/nchar.html"}}{\fldrslt \cf5 \strokec5 nchar}}(hidden)) \cf6 \strokec6 +\cf4 \strokec4  \cf6 \strokec6 2\cf4 \strokec4  \cf6 \strokec6 *\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/length.html"}}{\fldrslt \cf5 \strokec5 length}}(hidden) \cf6 \strokec6 -\cf4 \strokec4  \
            \cf6 \strokec6 2\cf4 \strokec4  \cf6 \strokec6 +\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Extremes.html"}}{\fldrslt \cf5 \strokec5 max}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/nchar.html"}}{\fldrslt \cf5 \strokec5 nchar}}(threshold)) \cf6 \strokec6 +\cf4 \strokec4  \cf6 \strokec6 2\cf4 \strokec4  \cf6 \strokec6 *\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/nchar.html"}}{\fldrslt \cf5 \strokec5 nchar}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/rep.html"}}{\fldrslt \cf5 \strokec5 rep}}) \cf6 \strokec6 +\cf4 \strokec4  \cf6 \strokec6 41\cf4 \strokec4 \
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/function.html"}}{\fldrslt \cf5 \strokec5 return}}(lifesign)\
\}\
\pard\pardeftab720\sl340\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://rdrr.io/cran/neuralnet/src/R/neuralnet.r"}}{\fldrslt \cf5 \strokec5 calculate.neuralnet}} \cf6 \strokec6 <-\cf4 \strokec4 \
\pard\pardeftab720\sl340\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/function.html"}}{\fldrslt \cf5 \strokec5 function}} ({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/utils/data.html"}}{\fldrslt \cf5 \strokec5 data}}, model.list, hidden, stepmax, {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/rep.html"}}{\fldrslt \cf5 \strokec5 rep}}, threshold, \
    learningrate.limit, learningrate.factor, lifesign, covariate, \
    response, lifesign.step, startweights, algorithm, act.fct, \
    act.deriv.fct, err.fct, err.deriv.fct, linear.output, likelihood, \
    exclude, constant.weights, learningrate.bp) \
\{\
    time.start.local \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Sys.time.html"}}{\fldrslt \cf5 \strokec5 Sys.time}}()\
    result \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/cran/neuralnet/src/R/neuralnet.r"}}{\fldrslt \cf5 \strokec5 generate.startweights}}(model.list, hidden, startweights, \
        {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/rep.html"}}{\fldrslt \cf5 \strokec5 rep}}, exclude, constant.weights)\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/weights.html"}}{\fldrslt \cf5 \strokec5 weights}} \cf6 \strokec6 <-\cf4 \strokec4  result\cf6 \strokec6 ${\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/weights.html"}}{\fldrslt \cf5 \strokec5 weights}}\cf4 \strokec4 \
    exclude \cf6 \strokec6 <-\cf4 \strokec4  result\cf6 \strokec6 $\cf4 \strokec4 exclude\
    nrow.weights \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/lapply.html"}}{\fldrslt \cf5 \strokec5 sapply}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/weights.html"}}{\fldrslt \cf5 \strokec5 weights}}, {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/nrow.html"}}{\fldrslt \cf5 \strokec5 nrow}})\
    ncol.weights \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/lapply.html"}}{\fldrslt \cf5 \strokec5 sapply}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/weights.html"}}{\fldrslt \cf5 \strokec5 weights}}, {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/nrow.html"}}{\fldrslt \cf5 \strokec5 ncol}})\
    result \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/cran/neuralnet/src/R/neuralnet.r"}}{\fldrslt \cf5 \strokec5 rprop}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/weights.html"}}{\fldrslt \cf5 \strokec5 weights}} \cf6 \strokec6 =\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/weights.html"}}{\fldrslt \cf5 \strokec5 weights}}, threshold \cf6 \strokec6 =\cf4 \strokec4  threshold, \
        response \cf6 \strokec6 =\cf4 \strokec4  response, covariate \cf6 \strokec6 =\cf4 \strokec4  covariate, learningrate.limit \cf6 \strokec6 =\cf4 \strokec4  learningrate.limit, \
        learningrate.factor \cf6 \strokec6 =\cf4 \strokec4  learningrate.factor, stepmax \cf6 \strokec6 =\cf4 \strokec4  stepmax, \
        lifesign \cf6 \strokec6 =\cf4 \strokec4  lifesign, lifesign.step \cf6 \strokec6 =\cf4 \strokec4  lifesign.step, act.fct \cf6 \strokec6 =\cf4 \strokec4  act.fct, \
        act.deriv.fct \cf6 \strokec6 =\cf4 \strokec4  act.deriv.fct, err.fct \cf6 \strokec6 =\cf4 \strokec4  err.fct, err.deriv.fct \cf6 \strokec6 =\cf4 \strokec4  err.deriv.fct, \
        algorithm \cf6 \strokec6 =\cf4 \strokec4  algorithm, linear.output \cf6 \strokec6 =\cf4 \strokec4  linear.output, \
        exclude \cf6 \strokec6 =\cf4 \strokec4  exclude, learningrate.bp \cf6 \strokec6 =\cf4 \strokec4  learningrate.bp)\
    startweights \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/weights.html"}}{\fldrslt \cf5 \strokec5 weights}}\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/weights.html"}}{\fldrslt \cf5 \strokec5 weights}} \cf6 \strokec6 <-\cf4 \strokec4  result\cf6 \strokec6 ${\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/weights.html"}}{\fldrslt \cf5 \strokec5 weights}}\cf4 \strokec4 \
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/step.html"}}{\fldrslt \cf5 \strokec5 step}} \cf6 \strokec6 <-\cf4 \strokec4  result\cf6 \strokec6 ${\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/step.html"}}{\fldrslt \cf5 \strokec5 step}}\cf4 \strokec4 \
    reached.threshold \cf6 \strokec6 <-\cf4 \strokec4  result\cf6 \strokec6 $\cf4 \strokec4 reached.threshold\
    net.result \cf6 \strokec6 <-\cf4 \strokec4  result\cf6 \strokec6 $\cf4 \strokec4 net.result\
    error \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/sum.html"}}{\fldrslt \cf5 \strokec5 sum}}(err.fct(net.result, response))\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} ({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/NA.html"}}{\fldrslt \cf5 \strokec5 is.na}}(error) \cf6 \strokec6 &\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/typeof.html"}}{\fldrslt \cf5 \strokec5 type}}(err.fct) \cf6 \strokec6 ==\cf4 \strokec4  \cf7 \strokec7 "ce"\cf4 \strokec4 ) \
        {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} ({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/all.html"}}{\fldrslt \cf5 \strokec5 all}}(net.result \cf6 \strokec6 <=\cf4 \strokec4  \cf6 \strokec6 1\cf4 \strokec4 , net.result \cf6 \strokec6 >=\cf4 \strokec4  \cf6 \strokec6 0\cf4 \strokec4 )) \
            error \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/sum.html"}}{\fldrslt \cf5 \strokec5 sum}}(err.fct(net.result, response), na.rm \cf6 \strokec6 =\cf4 \strokec4  \cf8 \strokec8 T\cf4 \strokec4 )\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} (\cf6 \strokec6 !{\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/NULL.html"}}{\fldrslt \cf5 \strokec5 is.null}}\cf4 \strokec4 (constant.weights) \cf6 \strokec6 &&\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/any.html"}}{\fldrslt \cf5 \strokec5 any}}(constant.weights \cf6 \strokec6 !=\cf4 \strokec4  \
        \cf6 \strokec6 0\cf4 \strokec4 )) \
        exclude \cf6 \strokec6 <-\cf4 \strokec4  exclude[\cf6 \strokec6 -{\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/which.html"}}{\fldrslt \cf5 \strokec5 which}}\cf4 \strokec4 (constant.weights \cf6 \strokec6 !=\cf4 \strokec4  \cf6 \strokec6 0\cf4 \strokec4 )]\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} ({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/length.html"}}{\fldrslt \cf5 \strokec5 length}}(exclude) \cf6 \strokec6 ==\cf4 \strokec4  \cf6 \strokec6 0\cf4 \strokec4 ) \
        exclude \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/NULL.html"}}{\fldrslt \cf5 \strokec5 NULL}}\
    aic \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/NULL.html"}}{\fldrslt \cf5 \strokec5 NULL}}\
    bic \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/NULL.html"}}{\fldrslt \cf5 \strokec5 NULL}}\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} (likelihood) \{\
        synapse.count \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/length.html"}}{\fldrslt \cf5 \strokec5 length}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/unlist.html"}}{\fldrslt \cf5 \strokec5 unlist}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/weights.html"}}{\fldrslt \cf5 \strokec5 weights}})) \cf6 \strokec6 -\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/length.html"}}{\fldrslt \cf5 \strokec5 length}}(exclude)\
        aic \cf6 \strokec6 <-\cf4 \strokec4  \cf6 \strokec6 2\cf4 \strokec4  \cf6 \strokec6 *\cf4 \strokec4  error \cf6 \strokec6 +\cf4 \strokec4  (\cf6 \strokec6 2\cf4 \strokec4  \cf6 \strokec6 *\cf4 \strokec4  synapse.count)\
        bic \cf6 \strokec6 <-\cf4 \strokec4  \cf6 \strokec6 2\cf4 \strokec4  \cf6 \strokec6 *\cf4 \strokec4  error \cf6 \strokec6 +\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Log.html"}}{\fldrslt \cf5 \strokec5 log}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/nrow.html"}}{\fldrslt \cf5 \strokec5 nrow}}(response)) \cf6 \strokec6 *\cf4 \strokec4  synapse.count\
    \}\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} ({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/NA.html"}}{\fldrslt \cf5 \strokec5 is.na}}(error)) \
        {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/warning.html"}}{\fldrslt \cf5 \strokec5 warning}}(\cf7 \strokec7 "'err.fct' does not fit 'data' or 'act.fct'"\cf4 \strokec4 , \
            call. \cf6 \strokec6 =\cf4 \strokec4  \cf8 \strokec8 F\cf4 \strokec4 )\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} (lifesign \cf6 \strokec6 !=\cf4 \strokec4  \cf7 \strokec7 "none"\cf4 \strokec4 ) \{\
        {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} (reached.threshold \cf6 \strokec6 <=\cf4 \strokec4  threshold) \{\
            {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/cat.html"}}{\fldrslt \cf5 \strokec5 cat}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/rep.html"}}{\fldrslt \cf5 \strokec5 rep}}(\cf7 \strokec7 " "\cf4 \strokec4 , ({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Extremes.html"}}{\fldrslt \cf5 \strokec5 max}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/nchar.html"}}{\fldrslt \cf5 \strokec5 nchar}}(stepmax), {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/nchar.html"}}{\fldrslt \cf5 \strokec5 nchar}}(\cf7 \strokec7 "stepmax"\cf4 \strokec4 )) \cf6 \strokec6 -\cf4 \strokec4  \
                {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/nchar.html"}}{\fldrslt \cf5 \strokec5 nchar}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/step.html"}}{\fldrslt \cf5 \strokec5 step}}))), {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/step.html"}}{\fldrslt \cf5 \strokec5 step}}, sep \cf6 \strokec6 =\cf4 \strokec4  \cf7 \strokec7 ""\cf4 \strokec4 )\
            {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/cat.html"}}{\fldrslt \cf5 \strokec5 cat}}(\cf7 \strokec7 "\\terror: "\cf4 \strokec4 , {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Round.html"}}{\fldrslt \cf5 \strokec5 round}}(error, \cf6 \strokec6 5\cf4 \strokec4 ), {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/rep.html"}}{\fldrslt \cf5 \strokec5 rep}}(\cf7 \strokec7 " "\cf4 \strokec4 , \cf6 \strokec6 6\cf4 \strokec4  \cf6 \strokec6 -\cf4 \strokec4  ({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/nchar.html"}}{\fldrslt \cf5 \strokec5 nchar}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Round.html"}}{\fldrslt \cf5 \strokec5 round}}(error, \
                \cf6 \strokec6 5\cf4 \strokec4 )) \cf6 \strokec6 -\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/nchar.html"}}{\fldrslt \cf5 \strokec5 nchar}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Round.html"}}{\fldrslt \cf5 \strokec5 round}}(error, \cf6 \strokec6 0\cf4 \strokec4 )))), sep \cf6 \strokec6 =\cf4 \strokec4  \cf7 \strokec7 ""\cf4 \strokec4 )\
            {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} (\cf6 \strokec6 !{\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/NULL.html"}}{\fldrslt \cf5 \strokec5 is.null}}\cf4 \strokec4 (aic)) \{\
                {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/cat.html"}}{\fldrslt \cf5 \strokec5 cat}}(\cf7 \strokec7 "\\taic: "\cf4 \strokec4 , {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Round.html"}}{\fldrslt \cf5 \strokec5 round}}(aic, \cf6 \strokec6 5\cf4 \strokec4 ), {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/rep.html"}}{\fldrslt \cf5 \strokec5 rep}}(\cf7 \strokec7 " "\cf4 \strokec4 , \cf6 \strokec6 6\cf4 \strokec4  \cf6 \strokec6 -\cf4 \strokec4  ({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/nchar.html"}}{\fldrslt \cf5 \strokec5 nchar}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Round.html"}}{\fldrslt \cf5 \strokec5 round}}(aic, \
                  \cf6 \strokec6 5\cf4 \strokec4 )) \cf6 \strokec6 -\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/nchar.html"}}{\fldrslt \cf5 \strokec5 nchar}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Round.html"}}{\fldrslt \cf5 \strokec5 round}}(aic, \cf6 \strokec6 0\cf4 \strokec4 )))), sep \cf6 \strokec6 =\cf4 \strokec4  \cf7 \strokec7 ""\cf4 \strokec4 )\
            \}\
            {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} (\cf6 \strokec6 !{\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/NULL.html"}}{\fldrslt \cf5 \strokec5 is.null}}\cf4 \strokec4 (bic)) \{\
                {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/cat.html"}}{\fldrslt \cf5 \strokec5 cat}}(\cf7 \strokec7 "\\tbic: "\cf4 \strokec4 , {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Round.html"}}{\fldrslt \cf5 \strokec5 round}}(bic, \cf6 \strokec6 5\cf4 \strokec4 ), {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/rep.html"}}{\fldrslt \cf5 \strokec5 rep}}(\cf7 \strokec7 " "\cf4 \strokec4 , \cf6 \strokec6 6\cf4 \strokec4  \cf6 \strokec6 -\cf4 \strokec4  ({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/nchar.html"}}{\fldrslt \cf5 \strokec5 nchar}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Round.html"}}{\fldrslt \cf5 \strokec5 round}}(bic, \
                  \cf6 \strokec6 5\cf4 \strokec4 )) \cf6 \strokec6 -\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/nchar.html"}}{\fldrslt \cf5 \strokec5 nchar}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Round.html"}}{\fldrslt \cf5 \strokec5 round}}(bic, \cf6 \strokec6 0\cf4 \strokec4 )))), sep \cf6 \strokec6 =\cf4 \strokec4  \cf7 \strokec7 ""\cf4 \strokec4 )\
            \}\
            {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/time.html"}}{\fldrslt \cf5 \strokec5 time}} \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/difftime.html"}}{\fldrslt \cf5 \strokec5 difftime}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Sys.time.html"}}{\fldrslt \cf5 \strokec5 Sys.time}}(), time.start.local)\
            {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/cat.html"}}{\fldrslt \cf5 \strokec5 cat}}(\cf7 \strokec7 "\\ttime: "\cf4 \strokec4 , {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Round.html"}}{\fldrslt \cf5 \strokec5 round}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/time.html"}}{\fldrslt \cf5 \strokec5 time}}, \cf6 \strokec6 2\cf4 \strokec4 ), \cf7 \strokec7 " "\cf4 \strokec4 , {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/attr.html"}}{\fldrslt \cf5 \strokec5 attr}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/time.html"}}{\fldrslt \cf5 \strokec5 time}}, \cf7 \strokec7 "units"\cf4 \strokec4 ), \
                sep \cf6 \strokec6 =\cf4 \strokec4  \cf7 \strokec7 ""\cf4 \strokec4 )\
            {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/cat.html"}}{\fldrslt \cf5 \strokec5 cat}}(\cf7 \strokec7 "\\n"\cf4 \strokec4 )\
        \}\
    \}\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} (reached.threshold \cf6 \strokec6 >\cf4 \strokec4  threshold) \
        {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/function.html"}}{\fldrslt \cf5 \strokec5 return}}(result \cf6 \strokec6 =\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/list.html"}}{\fldrslt \cf5 \strokec5 list}}(output.vector \cf6 \strokec6 =\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/NULL.html"}}{\fldrslt \cf5 \strokec5 NULL}}, {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/weights.html"}}{\fldrslt \cf5 \strokec5 weights}} \cf6 \strokec6 =\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/NULL.html"}}{\fldrslt \cf5 \strokec5 NULL}}))\
    output.vector \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/c.html"}}{\fldrslt \cf5 \strokec5 c}}(error \cf6 \strokec6 =\cf4 \strokec4  error, reached.threshold \cf6 \strokec6 =\cf4 \strokec4  reached.threshold, \
        steps \cf6 \strokec6 =\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/step.html"}}{\fldrslt \cf5 \strokec5 step}})\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} (\cf6 \strokec6 !{\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/NULL.html"}}{\fldrslt \cf5 \strokec5 is.null}}\cf4 \strokec4 (aic)) \{\
        output.vector \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/c.html"}}{\fldrslt \cf5 \strokec5 c}}(output.vector, aic \cf6 \strokec6 =\cf4 \strokec4  aic)\
    \}\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} (\cf6 \strokec6 !{\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/NULL.html"}}{\fldrslt \cf5 \strokec5 is.null}}\cf4 \strokec4 (bic)) \{\
        output.vector \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/c.html"}}{\fldrslt \cf5 \strokec5 c}}(output.vector, bic \cf6 \strokec6 =\cf4 \strokec4  bic)\
    \}\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 for}} (w {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 in}} \cf6 \strokec6 1:{\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/length.html"}}{\fldrslt \cf5 \strokec5 length}}\cf4 \strokec4 ({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/weights.html"}}{\fldrslt \cf5 \strokec5 weights}})) output.vector \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/c.html"}}{\fldrslt \cf5 \strokec5 c}}(output.vector, \
        {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/vector.html"}}{\fldrslt \cf5 \strokec5 as.vector}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/weights.html"}}{\fldrslt \cf5 \strokec5 weights}}[[w]]))\
    generalized.weights \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/cran/neuralnet/src/R/neuralnet.r"}}{\fldrslt \cf5 \strokec5 calculate.generalized.weights}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/weights.html"}}{\fldrslt \cf5 \strokec5 weights}}, \
        neuron.deriv \cf6 \strokec6 =\cf4 \strokec4  result\cf6 \strokec6 $\cf4 \strokec4 neuron.deriv, net.result \cf6 \strokec6 =\cf4 \strokec4  net.result)\
    startweights \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/unlist.html"}}{\fldrslt \cf5 \strokec5 unlist}}(startweights)\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/weights.html"}}{\fldrslt \cf5 \strokec5 weights}} \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/unlist.html"}}{\fldrslt \cf5 \strokec5 unlist}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/weights.html"}}{\fldrslt \cf5 \strokec5 weights}})\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} (\cf6 \strokec6 !{\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/NULL.html"}}{\fldrslt \cf5 \strokec5 is.null}}\cf4 \strokec4 (exclude)) \{\
        startweights[exclude] \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/NA.html"}}{\fldrslt \cf5 \strokec5 NA}}\
        {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/weights.html"}}{\fldrslt \cf5 \strokec5 weights}}[exclude] \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/NA.html"}}{\fldrslt \cf5 \strokec5 NA}}\
    \}\
    startweights \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/utils/relist.html"}}{\fldrslt \cf5 \strokec5 relist}}(startweights, nrow.weights, ncol.weights)\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/weights.html"}}{\fldrslt \cf5 \strokec5 weights}} \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/utils/relist.html"}}{\fldrslt \cf5 \strokec5 relist}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/weights.html"}}{\fldrslt \cf5 \strokec5 weights}}, nrow.weights, ncol.weights)\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/function.html"}}{\fldrslt \cf5 \strokec5 return}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/list.html"}}{\fldrslt \cf5 \strokec5 list}}(generalized.weights \cf6 \strokec6 =\cf4 \strokec4  generalized.weights, {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/weights.html"}}{\fldrslt \cf5 \strokec5 weights}} \cf6 \strokec6 =\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/weights.html"}}{\fldrslt \cf5 \strokec5 weights}}, \
        startweights \cf6 \strokec6 =\cf4 \strokec4  startweights, net.result \cf6 \strokec6 =\cf4 \strokec4  result\cf6 \strokec6 $\cf4 \strokec4 net.result, \
        output.vector \cf6 \strokec6 =\cf4 \strokec4  output.vector))\
\}\
\pard\pardeftab720\sl340\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://rdrr.io/cran/neuralnet/src/R/neuralnet.r"}}{\fldrslt \cf5 \strokec5 generate.startweights}} \cf6 \strokec6 <-\cf4 \strokec4 \
\pard\pardeftab720\sl340\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/function.html"}}{\fldrslt \cf5 \strokec5 function}} (model.list, hidden, startweights, {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/rep.html"}}{\fldrslt \cf5 \strokec5 rep}}, exclude, constant.weights) \
\{\
    input.count \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/length.html"}}{\fldrslt \cf5 \strokec5 length}}(model.list\cf6 \strokec6 $\cf4 \strokec4 variables)\
    output.count \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/length.html"}}{\fldrslt \cf5 \strokec5 length}}(model.list\cf6 \strokec6 $\cf4 \strokec4 response)\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} (\cf6 \strokec6 !\cf4 \strokec4 ({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/length.html"}}{\fldrslt \cf5 \strokec5 length}}(hidden) \cf6 \strokec6 ==\cf4 \strokec4  \cf6 \strokec6 1\cf4 \strokec4  \cf6 \strokec6 &&\cf4 \strokec4  hidden \cf6 \strokec6 ==\cf4 \strokec4  \cf6 \strokec6 0\cf4 \strokec4 )) \{\
        length.weights \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/length.html"}}{\fldrslt \cf5 \strokec5 length}}(hidden) \cf6 \strokec6 +\cf4 \strokec4  \cf6 \strokec6 1\cf4 \strokec4 \
        nrow.weights \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/array.html"}}{\fldrslt \cf5 \strokec5 array}}(\cf6 \strokec6 0\cf4 \strokec4 , {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/dim.html"}}{\fldrslt \cf5 \strokec5 dim}} \cf6 \strokec6 =\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/c.html"}}{\fldrslt \cf5 \strokec5 c}}(length.weights))\
        ncol.weights \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/array.html"}}{\fldrslt \cf5 \strokec5 array}}(\cf6 \strokec6 0\cf4 \strokec4 , {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/dim.html"}}{\fldrslt \cf5 \strokec5 dim}} \cf6 \strokec6 =\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/c.html"}}{\fldrslt \cf5 \strokec5 c}}(length.weights))\
        nrow.weights[\cf6 \strokec6 1\cf4 \strokec4 ] \cf6 \strokec6 <-\cf4 \strokec4  (input.count \cf6 \strokec6 +\cf4 \strokec4  \cf6 \strokec6 1\cf4 \strokec4 )\
        ncol.weights[\cf6 \strokec6 1\cf4 \strokec4 ] \cf6 \strokec6 <-\cf4 \strokec4  hidden[\cf6 \strokec6 1\cf4 \strokec4 ]\
        {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} ({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/length.html"}}{\fldrslt \cf5 \strokec5 length}}(hidden) \cf6 \strokec6 >\cf4 \strokec4  \cf6 \strokec6 1\cf4 \strokec4 ) \
            {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 for}} (i {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 in}} \cf6 \strokec6 2:{\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/length.html"}}{\fldrslt \cf5 \strokec5 length}}\cf4 \strokec4 (hidden)) \{\
                nrow.weights[i] \cf6 \strokec6 <-\cf4 \strokec4  hidden[i \cf6 \strokec6 -\cf4 \strokec4  \cf6 \strokec6 1\cf4 \strokec4 ] \cf6 \strokec6 +\cf4 \strokec4  \cf6 \strokec6 1\cf4 \strokec4 \
                ncol.weights[i] \cf6 \strokec6 <-\cf4 \strokec4  hidden[i]\
            \}\
        nrow.weights[length.weights] \cf6 \strokec6 <-\cf4 \strokec4  hidden[length.weights \cf6 \strokec6 -\cf4 \strokec4  \
            \cf6 \strokec6 1\cf4 \strokec4 ] \cf6 \strokec6 +\cf4 \strokec4  \cf6 \strokec6 1\cf4 \strokec4 \
        ncol.weights[length.weights] \cf6 \strokec6 <-\cf4 \strokec4  output.count\
    \}\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 else}} \{\
        length.weights \cf6 \strokec6 <-\cf4 \strokec4  \cf6 \strokec6 1\cf4 \strokec4 \
        nrow.weights \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/array.html"}}{\fldrslt \cf5 \strokec5 array}}((input.count \cf6 \strokec6 +\cf4 \strokec4  \cf6 \strokec6 1\cf4 \strokec4 ), {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/dim.html"}}{\fldrslt \cf5 \strokec5 dim}} \cf6 \strokec6 =\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/c.html"}}{\fldrslt \cf5 \strokec5 c}}(\cf6 \strokec6 1\cf4 \strokec4 ))\
        ncol.weights \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/array.html"}}{\fldrslt \cf5 \strokec5 array}}(output.count, {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/dim.html"}}{\fldrslt \cf5 \strokec5 dim}} \cf6 \strokec6 =\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/c.html"}}{\fldrslt \cf5 \strokec5 c}}(\cf6 \strokec6 1\cf4 \strokec4 ))\
    \}\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/length.html"}}{\fldrslt \cf5 \strokec5 length}} \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/sum.html"}}{\fldrslt \cf5 \strokec5 sum}}(ncol.weights \cf6 \strokec6 *\cf4 \strokec4  nrow.weights)\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/vector.html"}}{\fldrslt \cf5 \strokec5 vector}} \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/rep.html"}}{\fldrslt \cf5 \strokec5 rep}}(\cf6 \strokec6 0\cf4 \strokec4 , {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/length.html"}}{\fldrslt \cf5 \strokec5 length}})\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} (\cf6 \strokec6 !{\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/NULL.html"}}{\fldrslt \cf5 \strokec5 is.null}}\cf4 \strokec4 (exclude)) \{\
        {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} ({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/matrix.html"}}{\fldrslt \cf5 \strokec5 is.matrix}}(exclude)) \{\
            exclude \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/matrix.html"}}{\fldrslt \cf5 \strokec5 matrix}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/integer.html"}}{\fldrslt \cf5 \strokec5 as.integer}}(exclude), {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/nrow.html"}}{\fldrslt \cf5 \strokec5 ncol}} \cf6 \strokec6 =\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/nrow.html"}}{\fldrslt \cf5 \strokec5 ncol}}(exclude), \
                {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/nrow.html"}}{\fldrslt \cf5 \strokec5 nrow}} \cf6 \strokec6 =\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/nrow.html"}}{\fldrslt \cf5 \strokec5 nrow}}(exclude))\
            {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} ({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/nrow.html"}}{\fldrslt \cf5 \strokec5 nrow}}(exclude) \cf6 \strokec6 >=\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/length.html"}}{\fldrslt \cf5 \strokec5 length}} \cf6 \strokec6 ||\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/nrow.html"}}{\fldrslt \cf5 \strokec5 ncol}}(exclude) \cf6 \strokec6 !=\cf4 \strokec4  \cf6 \strokec6 3\cf4 \strokec4 ) \
                {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/stop.html"}}{\fldrslt \cf5 \strokec5 stop}}(\cf7 \strokec7 "'exclude' has wrong dimensions"\cf4 \strokec4 , call. \cf6 \strokec6 =\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/logical.html"}}{\fldrslt \cf5 \strokec5 FALSE}})\
            {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} ({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/any.html"}}{\fldrslt \cf5 \strokec5 any}}(exclude \cf6 \strokec6 <\cf4 \strokec4  \cf6 \strokec6 1\cf4 \strokec4 )) \
                {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/stop.html"}}{\fldrslt \cf5 \strokec5 stop}}(\cf7 \strokec7 "'exclude' contains at least one invalid weight"\cf4 \strokec4 , \
                  call. \cf6 \strokec6 =\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/logical.html"}}{\fldrslt \cf5 \strokec5 FALSE}})\
            temp \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/utils/relist.html"}}{\fldrslt \cf5 \strokec5 relist}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/vector.html"}}{\fldrslt \cf5 \strokec5 vector}}, nrow.weights, ncol.weights)\
            {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 for}} (i {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 in}} \cf6 \strokec6 1:{\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/nrow.html"}}{\fldrslt \cf5 \strokec5 nrow}}\cf4 \strokec4 (exclude)) \{\
                {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} (exclude[i, \cf6 \strokec6 1\cf4 \strokec4 ] \cf6 \strokec6 >\cf4 \strokec4  length.weights \cf6 \strokec6 ||\cf4 \strokec4  exclude[i, \
                  \cf6 \strokec6 2\cf4 \strokec4 ] \cf6 \strokec6 >\cf4 \strokec4  nrow.weights[exclude[i, \cf6 \strokec6 1\cf4 \strokec4 ]] \cf6 \strokec6 ||\cf4 \strokec4  exclude[i, \
                  \cf6 \strokec6 3\cf4 \strokec4 ] \cf6 \strokec6 >\cf4 \strokec4  ncol.weights[exclude[i, \cf6 \strokec6 1\cf4 \strokec4 ]]) \
                  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/stop.html"}}{\fldrslt \cf5 \strokec5 stop}}(\cf7 \strokec7 "'exclude' contains at least one invalid weight"\cf4 \strokec4 , \
                    call. \cf6 \strokec6 =\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/logical.html"}}{\fldrslt \cf5 \strokec5 FALSE}})\
                temp[[exclude[i, \cf6 \strokec6 1\cf4 \strokec4 ]]][exclude[i, \cf6 \strokec6 2\cf4 \strokec4 ], exclude[i, \
                  \cf6 \strokec6 3\cf4 \strokec4 ]] \cf6 \strokec6 <-\cf4 \strokec4  \cf6 \strokec6 1\cf4 \strokec4 \
            \}\
            exclude \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/which.html"}}{\fldrslt \cf5 \strokec5 which}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/unlist.html"}}{\fldrslt \cf5 \strokec5 unlist}}(temp) \cf6 \strokec6 ==\cf4 \strokec4  \cf6 \strokec6 1\cf4 \strokec4 )\
        \}\
        {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 else}} {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} ({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/vector.html"}}{\fldrslt \cf5 \strokec5 is.vector}}(exclude)) \{\
            exclude \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/integer.html"}}{\fldrslt \cf5 \strokec5 as.integer}}(exclude)\
            {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} ({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Extremes.html"}}{\fldrslt \cf5 \strokec5 max}}(exclude) \cf6 \strokec6 >\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/length.html"}}{\fldrslt \cf5 \strokec5 length}} \cf6 \strokec6 ||\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Extremes.html"}}{\fldrslt \cf5 \strokec5 min}}(exclude) \cf6 \strokec6 <\cf4 \strokec4  \cf6 \strokec6 1\cf4 \strokec4 ) \{\
                {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/stop.html"}}{\fldrslt \cf5 \strokec5 stop}}(\cf7 \strokec7 "'exclude' contains at least one invalid weight"\cf4 \strokec4 , \
                  call. \cf6 \strokec6 =\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/logical.html"}}{\fldrslt \cf5 \strokec5 FALSE}})\
            \}\
        \}\
        {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 else}} \{\
            {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/stop.html"}}{\fldrslt \cf5 \strokec5 stop}}(\cf7 \strokec7 "'exclude' must be a vector or matrix"\cf4 \strokec4 , call. \cf6 \strokec6 =\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/logical.html"}}{\fldrslt \cf5 \strokec5 FALSE}})\
        \}\
        {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} ({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/length.html"}}{\fldrslt \cf5 \strokec5 length}}(exclude) \cf6 \strokec6 >=\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/length.html"}}{\fldrslt \cf5 \strokec5 length}}) \
            {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/stop.html"}}{\fldrslt \cf5 \strokec5 stop}}(\cf7 \strokec7 "all weights are exluded"\cf4 \strokec4 , call. \cf6 \strokec6 =\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/logical.html"}}{\fldrslt \cf5 \strokec5 FALSE}})\
    \}\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/length.html"}}{\fldrslt \cf5 \strokec5 length}} \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/length.html"}}{\fldrslt \cf5 \strokec5 length}} \cf6 \strokec6 -\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/length.html"}}{\fldrslt \cf5 \strokec5 length}}(exclude)\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} (\cf6 \strokec6 !{\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/NULL.html"}}{\fldrslt \cf5 \strokec5 is.null}}\cf4 \strokec4 (exclude)) \{\
        {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} ({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/NULL.html"}}{\fldrslt \cf5 \strokec5 is.null}}(startweights) \cf6 \strokec6 ||\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/length.html"}}{\fldrslt \cf5 \strokec5 length}}(startweights) \cf6 \strokec6 <\cf4 \strokec4  ({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/length.html"}}{\fldrslt \cf5 \strokec5 length}} \cf6 \strokec6 *\cf4 \strokec4  \
            {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/rep.html"}}{\fldrslt \cf5 \strokec5 rep}})) \
            {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/vector.html"}}{\fldrslt \cf5 \strokec5 vector}}[\cf6 \strokec6 -\cf4 \strokec4 exclude] \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/stats-package.html"}}{\fldrslt \cf5 \strokec5 stats}}\cf6 \strokec6 ::{\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/Normal.html"}}{\fldrslt \cf5 \strokec5 rnorm}}\cf4 \strokec4 ({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/length.html"}}{\fldrslt \cf5 \strokec5 length}})\
        {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 else}} {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/vector.html"}}{\fldrslt \cf5 \strokec5 vector}}[\cf6 \strokec6 -\cf4 \strokec4 exclude] \cf6 \strokec6 <-\cf4 \strokec4  startweights[(({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/rep.html"}}{\fldrslt \cf5 \strokec5 rep}} \cf6 \strokec6 -\cf4 \strokec4  \cf6 \strokec6 1\cf4 \strokec4 ) \cf6 \strokec6 *\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/length.html"}}{\fldrslt \cf5 \strokec5 length}} \cf6 \strokec6 +\cf4 \strokec4  \
            \cf6 \strokec6 1\cf4 \strokec4 )\cf6 \strokec6 :\cf4 \strokec4 ({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/length.html"}}{\fldrslt \cf5 \strokec5 length}} \cf6 \strokec6 *\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/rep.html"}}{\fldrslt \cf5 \strokec5 rep}})]\
    \}\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 else}} \{\
        {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} ({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/NULL.html"}}{\fldrslt \cf5 \strokec5 is.null}}(startweights) \cf6 \strokec6 ||\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/length.html"}}{\fldrslt \cf5 \strokec5 length}}(startweights) \cf6 \strokec6 <\cf4 \strokec4  ({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/length.html"}}{\fldrslt \cf5 \strokec5 length}} \cf6 \strokec6 *\cf4 \strokec4  \
            {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/rep.html"}}{\fldrslt \cf5 \strokec5 rep}})) \
            {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/vector.html"}}{\fldrslt \cf5 \strokec5 vector}} \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/stats-package.html"}}{\fldrslt \cf5 \strokec5 stats}}\cf6 \strokec6 ::{\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/Normal.html"}}{\fldrslt \cf5 \strokec5 rnorm}}\cf4 \strokec4 ({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/length.html"}}{\fldrslt \cf5 \strokec5 length}})\
        {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 else}} {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/vector.html"}}{\fldrslt \cf5 \strokec5 vector}} \cf6 \strokec6 <-\cf4 \strokec4  startweights[(({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/rep.html"}}{\fldrslt \cf5 \strokec5 rep}} \cf6 \strokec6 -\cf4 \strokec4  \cf6 \strokec6 1\cf4 \strokec4 ) \cf6 \strokec6 *\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/length.html"}}{\fldrslt \cf5 \strokec5 length}} \cf6 \strokec6 +\cf4 \strokec4  \cf6 \strokec6 1\cf4 \strokec4 )\cf6 \strokec6 :\cf4 \strokec4 ({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/length.html"}}{\fldrslt \cf5 \strokec5 length}} \cf6 \strokec6 *\cf4 \strokec4  \
            {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/rep.html"}}{\fldrslt \cf5 \strokec5 rep}})]\
    \}\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} (\cf6 \strokec6 !{\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/NULL.html"}}{\fldrslt \cf5 \strokec5 is.null}}\cf4 \strokec4 (exclude) \cf6 \strokec6 &&\cf4 \strokec4  \cf6 \strokec6 !{\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/NULL.html"}}{\fldrslt \cf5 \strokec5 is.null}}\cf4 \strokec4 (constant.weights)) \{\
        {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} ({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/length.html"}}{\fldrslt \cf5 \strokec5 length}}(exclude) \cf6 \strokec6 <\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/length.html"}}{\fldrslt \cf5 \strokec5 length}}(constant.weights)) \
            {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/stop.html"}}{\fldrslt \cf5 \strokec5 stop}}(\cf7 \strokec7 "constant.weights contains more weights than exclude"\cf4 \strokec4 , \
                call. \cf6 \strokec6 =\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/logical.html"}}{\fldrslt \cf5 \strokec5 FALSE}})\
        {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 else}} {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/vector.html"}}{\fldrslt \cf5 \strokec5 vector}}[exclude[\cf6 \strokec6 1:{\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/length.html"}}{\fldrslt \cf5 \strokec5 length}}\cf4 \strokec4 (constant.weights)]] \cf6 \strokec6 <-\cf4 \strokec4  constant.weights\
    \}\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/weights.html"}}{\fldrslt \cf5 \strokec5 weights}} \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/utils/relist.html"}}{\fldrslt \cf5 \strokec5 relist}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/vector.html"}}{\fldrslt \cf5 \strokec5 vector}}, nrow.weights, ncol.weights)\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/function.html"}}{\fldrslt \cf5 \strokec5 return}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/list.html"}}{\fldrslt \cf5 \strokec5 list}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/weights.html"}}{\fldrslt \cf5 \strokec5 weights}} \cf6 \strokec6 =\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/weights.html"}}{\fldrslt \cf5 \strokec5 weights}}, exclude \cf6 \strokec6 =\cf4 \strokec4  exclude))\
\}\
\pard\pardeftab720\sl340\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://rdrr.io/cran/neuralnet/src/R/neuralnet.r"}}{\fldrslt \cf5 \strokec5 rprop}} \cf6 \strokec6 <-\cf4 \strokec4 \
\pard\pardeftab720\sl340\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/function.html"}}{\fldrslt \cf5 \strokec5 function}} ({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/weights.html"}}{\fldrslt \cf5 \strokec5 weights}}, response, covariate, threshold, learningrate.limit, \
    learningrate.factor, stepmax, lifesign, lifesign.step, act.fct, \
    act.deriv.fct, err.fct, err.deriv.fct, algorithm, linear.output, \
    exclude, learningrate.bp) \
\{\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/step.html"}}{\fldrslt \cf5 \strokec5 step}} \cf6 \strokec6 <-\cf4 \strokec4  \cf6 \strokec6 1\cf4 \strokec4 \
    nchar.stepmax \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Extremes.html"}}{\fldrslt \cf5 \strokec5 max}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/nchar.html"}}{\fldrslt \cf5 \strokec5 nchar}}(stepmax), \cf6 \strokec6 7\cf4 \strokec4 )\
    length.weights \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/length.html"}}{\fldrslt \cf5 \strokec5 length}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/weights.html"}}{\fldrslt \cf5 \strokec5 weights}})\
    nrow.weights \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/lapply.html"}}{\fldrslt \cf5 \strokec5 sapply}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/weights.html"}}{\fldrslt \cf5 \strokec5 weights}}, {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/nrow.html"}}{\fldrslt \cf5 \strokec5 nrow}})\
    ncol.weights \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/lapply.html"}}{\fldrslt \cf5 \strokec5 sapply}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/weights.html"}}{\fldrslt \cf5 \strokec5 weights}}, {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/nrow.html"}}{\fldrslt \cf5 \strokec5 ncol}})\
    length.unlist \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/length.html"}}{\fldrslt \cf5 \strokec5 length}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/unlist.html"}}{\fldrslt \cf5 \strokec5 unlist}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/weights.html"}}{\fldrslt \cf5 \strokec5 weights}})) \cf6 \strokec6 -\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/length.html"}}{\fldrslt \cf5 \strokec5 length}}(exclude)\
    learningrate \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/vector.html"}}{\fldrslt \cf5 \strokec5 as.vector}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/matrix.html"}}{\fldrslt \cf5 \strokec5 matrix}}(\cf6 \strokec6 0.1\cf4 \strokec4 , {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/nrow.html"}}{\fldrslt \cf5 \strokec5 nrow}} \cf6 \strokec6 =\cf4 \strokec4  \cf6 \strokec6 1\cf4 \strokec4 , {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/nrow.html"}}{\fldrslt \cf5 \strokec5 ncol}} \cf6 \strokec6 =\cf4 \strokec4  length.unlist))\
    gradients.old \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/vector.html"}}{\fldrslt \cf5 \strokec5 as.vector}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/matrix.html"}}{\fldrslt \cf5 \strokec5 matrix}}(\cf6 \strokec6 0\cf4 \strokec4 , {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/nrow.html"}}{\fldrslt \cf5 \strokec5 nrow}} \cf6 \strokec6 =\cf4 \strokec4  \cf6 \strokec6 1\cf4 \strokec4 , {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/nrow.html"}}{\fldrslt \cf5 \strokec5 ncol}} \cf6 \strokec6 =\cf4 \strokec4  length.unlist))\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} ({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/NULL.html"}}{\fldrslt \cf5 \strokec5 is.null}}(exclude)) \
        exclude \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/length.html"}}{\fldrslt \cf5 \strokec5 length}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/unlist.html"}}{\fldrslt \cf5 \strokec5 unlist}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/weights.html"}}{\fldrslt \cf5 \strokec5 weights}})) \cf6 \strokec6 +\cf4 \strokec4  \cf6 \strokec6 1\cf4 \strokec4 \
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} ({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/typeof.html"}}{\fldrslt \cf5 \strokec5 type}}(act.fct) \cf6 \strokec6 ==\cf4 \strokec4  \cf7 \strokec7 "tanh"\cf4 \strokec4  \cf6 \strokec6 ||\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/typeof.html"}}{\fldrslt \cf5 \strokec5 type}}(act.fct) \cf6 \strokec6 ==\cf4 \strokec4  \cf7 \strokec7 "logistic"\cf4 \strokec4 ) \
        special \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/logical.html"}}{\fldrslt \cf5 \strokec5 TRUE}}\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 else}} special \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/logical.html"}}{\fldrslt \cf5 \strokec5 FALSE}}\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} (linear.output) \{\
        output.act.fct \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/function.html"}}{\fldrslt \cf5 \strokec5 function}}(x) \{\
            x\
        \}\
        output.act.deriv.fct \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/function.html"}}{\fldrslt \cf5 \strokec5 function}}(x) \{\
            {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/matrix.html"}}{\fldrslt \cf5 \strokec5 matrix}}(\cf6 \strokec6 1\cf4 \strokec4 , {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/nrow.html"}}{\fldrslt \cf5 \strokec5 nrow}}(x), {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/nrow.html"}}{\fldrslt \cf5 \strokec5 ncol}}(x))\
        \}\
    \}\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 else}} \{\
        {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} ({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/typeof.html"}}{\fldrslt \cf5 \strokec5 type}}(err.fct) \cf6 \strokec6 ==\cf4 \strokec4  \cf7 \strokec7 "ce"\cf4 \strokec4  \cf6 \strokec6 &&\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/typeof.html"}}{\fldrslt \cf5 \strokec5 type}}(act.fct) \cf6 \strokec6 ==\cf4 \strokec4  \cf7 \strokec7 "logistic"\cf4 \strokec4 ) \{\
            err.deriv.fct \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/function.html"}}{\fldrslt \cf5 \strokec5 function}}(x, y) \{\
                x \cf6 \strokec6 *\cf4 \strokec4  (\cf6 \strokec6 1\cf4 \strokec4  \cf6 \strokec6 -\cf4 \strokec4  y) \cf6 \strokec6 -\cf4 \strokec4  y \cf6 \strokec6 *\cf4 \strokec4  (\cf6 \strokec6 1\cf4 \strokec4  \cf6 \strokec6 -\cf4 \strokec4  x)\
            \}\
            linear.output \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/logical.html"}}{\fldrslt \cf5 \strokec5 TRUE}}\
        \}\
        output.act.fct \cf6 \strokec6 <-\cf4 \strokec4  act.fct\
        output.act.deriv.fct \cf6 \strokec6 <-\cf4 \strokec4  act.deriv.fct\
    \}\
    result \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/cran/neuralnet/src/R/neuralnet.r"}}{\fldrslt \cf5 \strokec5 compute.net}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/weights.html"}}{\fldrslt \cf5 \strokec5 weights}}, length.weights, covariate \cf6 \strokec6 =\cf4 \strokec4  covariate, \
        act.fct \cf6 \strokec6 =\cf4 \strokec4  act.fct, act.deriv.fct \cf6 \strokec6 =\cf4 \strokec4  act.deriv.fct, output.act.fct \cf6 \strokec6 =\cf4 \strokec4  output.act.fct, \
        output.act.deriv.fct \cf6 \strokec6 =\cf4 \strokec4  output.act.deriv.fct, special)\
    err.deriv \cf6 \strokec6 <-\cf4 \strokec4  err.deriv.fct(result\cf6 \strokec6 $\cf4 \strokec4 net.result, response)\
    gradients \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/cran/neuralnet/src/R/neuralnet.r"}}{\fldrslt \cf5 \strokec5 calculate.gradients}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/weights.html"}}{\fldrslt \cf5 \strokec5 weights}} \cf6 \strokec6 =\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/weights.html"}}{\fldrslt \cf5 \strokec5 weights}}, length.weights \cf6 \strokec6 =\cf4 \strokec4  length.weights, \
        neurons \cf6 \strokec6 =\cf4 \strokec4  result\cf6 \strokec6 $\cf4 \strokec4 neurons, neuron.deriv \cf6 \strokec6 =\cf4 \strokec4  result\cf6 \strokec6 $\cf4 \strokec4 neuron.deriv, \
        err.deriv \cf6 \strokec6 =\cf4 \strokec4  err.deriv, exclude \cf6 \strokec6 =\cf4 \strokec4  exclude, linear.output \cf6 \strokec6 =\cf4 \strokec4  linear.output)\
    reached.threshold \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Extremes.html"}}{\fldrslt \cf5 \strokec5 max}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/MathFun.html"}}{\fldrslt \cf5 \strokec5 abs}}(gradients))\
    min.reached.threshold \cf6 \strokec6 <-\cf4 \strokec4  reached.threshold\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 while}} ({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/step.html"}}{\fldrslt \cf5 \strokec5 step}} \cf6 \strokec6 <\cf4 \strokec4  stepmax \cf6 \strokec6 &&\cf4 \strokec4  reached.threshold \cf6 \strokec6 >\cf4 \strokec4  threshold) \{\
        {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} (\cf6 \strokec6 !{\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/character.html"}}{\fldrslt \cf5 \strokec5 is.character}}\cf4 \strokec4 (lifesign) \cf6 \strokec6 &&\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/step.html"}}{\fldrslt \cf5 \strokec5 step}}\cf6 \strokec6 %%\cf4 \strokec4 lifesign.step \cf6 \strokec6 ==\cf4 \strokec4  \
            \cf6 \strokec6 0\cf4 \strokec4 ) \{\
            {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/graphics/text.html"}}{\fldrslt \cf5 \strokec5 text}} \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/paste.html"}}{\fldrslt \cf5 \strokec5 paste}}(\cf7 \strokec7 "%"\cf4 \strokec4 , nchar.stepmax, \cf7 \strokec7 "s"\cf4 \strokec4 , sep \cf6 \strokec6 =\cf4 \strokec4  \cf7 \strokec7 ""\cf4 \strokec4 )\
            {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/cat.html"}}{\fldrslt \cf5 \strokec5 cat}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/sprintf.html"}}{\fldrslt \cf5 \strokec5 sprintf}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/eval.html"}}{\fldrslt \cf5 \strokec5 eval}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/expression.html"}}{\fldrslt \cf5 \strokec5 expression}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/graphics/text.html"}}{\fldrslt \cf5 \strokec5 text}})), {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/step.html"}}{\fldrslt \cf5 \strokec5 step}}), \cf7 \strokec7 "\\tmin thresh: "\cf4 \strokec4 , \
                min.reached.threshold, \cf7 \strokec7 "\\n"\cf4 \strokec4 , {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/rep.html"}}{\fldrslt \cf5 \strokec5 rep}}(\cf7 \strokec7 " "\cf4 \strokec4 , lifesign), \
                sep \cf6 \strokec6 =\cf4 \strokec4  \cf7 \strokec7 ""\cf4 \strokec4 )\
            {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/utils/utils-package.html"}}{\fldrslt \cf5 \strokec5 utils}}\cf6 \strokec6 ::{\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/utils/flush.console.html"}}{\fldrslt \cf5 \strokec5 flush.console}}\cf4 \strokec4 ()\
        \}\
        {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} (algorithm \cf6 \strokec6 ==\cf4 \strokec4  \cf7 \strokec7 "rprop+"\cf4 \strokec4 ) \
            result \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/cran/neuralnet/src/R/neuralnet.r"}}{\fldrslt \cf5 \strokec5 plus}}(gradients, gradients.old, {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/weights.html"}}{\fldrslt \cf5 \strokec5 weights}}, \
                nrow.weights, ncol.weights, learningrate, learningrate.factor, \
                learningrate.limit, exclude)\
        {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 else}} {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} (algorithm \cf6 \strokec6 ==\cf4 \strokec4  \cf7 \strokec7 "backprop"\cf4 \strokec4 ) \
            result \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/cran/neuralnet/src/R/neuralnet.r"}}{\fldrslt \cf5 \strokec5 backprop}}(gradients, {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/weights.html"}}{\fldrslt \cf5 \strokec5 weights}}, length.weights, \
                nrow.weights, ncol.weights, learningrate.bp, \
                exclude)\
        {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 else}} result \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/cran/neuralnet/src/R/neuralnet.r"}}{\fldrslt \cf5 \strokec5 minus}}(gradients, gradients.old, {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/weights.html"}}{\fldrslt \cf5 \strokec5 weights}}, \
            length.weights, nrow.weights, ncol.weights, learningrate, \
            learningrate.factor, learningrate.limit, algorithm, \
            exclude)\
        gradients.old \cf6 \strokec6 <-\cf4 \strokec4  result\cf6 \strokec6 $\cf4 \strokec4 gradients.old\
        {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/weights.html"}}{\fldrslt \cf5 \strokec5 weights}} \cf6 \strokec6 <-\cf4 \strokec4  result\cf6 \strokec6 ${\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/weights.html"}}{\fldrslt \cf5 \strokec5 weights}}\cf4 \strokec4 \
        learningrate \cf6 \strokec6 <-\cf4 \strokec4  result\cf6 \strokec6 $\cf4 \strokec4 learningrate\
        result \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/cran/neuralnet/src/R/neuralnet.r"}}{\fldrslt \cf5 \strokec5 compute.net}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/weights.html"}}{\fldrslt \cf5 \strokec5 weights}}, length.weights, covariate \cf6 \strokec6 =\cf4 \strokec4  covariate, \
            act.fct \cf6 \strokec6 =\cf4 \strokec4  act.fct, act.deriv.fct \cf6 \strokec6 =\cf4 \strokec4  act.deriv.fct, \
            output.act.fct \cf6 \strokec6 =\cf4 \strokec4  output.act.fct, output.act.deriv.fct \cf6 \strokec6 =\cf4 \strokec4  output.act.deriv.fct, \
            special)\
        err.deriv \cf6 \strokec6 <-\cf4 \strokec4  err.deriv.fct(result\cf6 \strokec6 $\cf4 \strokec4 net.result, response)\
        gradients \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/cran/neuralnet/src/R/neuralnet.r"}}{\fldrslt \cf5 \strokec5 calculate.gradients}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/weights.html"}}{\fldrslt \cf5 \strokec5 weights}} \cf6 \strokec6 =\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/weights.html"}}{\fldrslt \cf5 \strokec5 weights}}, length.weights \cf6 \strokec6 =\cf4 \strokec4  length.weights, \
            neurons \cf6 \strokec6 =\cf4 \strokec4  result\cf6 \strokec6 $\cf4 \strokec4 neurons, neuron.deriv \cf6 \strokec6 =\cf4 \strokec4  result\cf6 \strokec6 $\cf4 \strokec4 neuron.deriv, \
            err.deriv \cf6 \strokec6 =\cf4 \strokec4  err.deriv, exclude \cf6 \strokec6 =\cf4 \strokec4  exclude, linear.output \cf6 \strokec6 =\cf4 \strokec4  linear.output)\
        reached.threshold \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Extremes.html"}}{\fldrslt \cf5 \strokec5 max}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/MathFun.html"}}{\fldrslt \cf5 \strokec5 abs}}(gradients))\
        {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} (reached.threshold \cf6 \strokec6 <\cf4 \strokec4  min.reached.threshold) \{\
            min.reached.threshold \cf6 \strokec6 <-\cf4 \strokec4  reached.threshold\
        \}\
        {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/step.html"}}{\fldrslt \cf5 \strokec5 step}} \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/step.html"}}{\fldrslt \cf5 \strokec5 step}} \cf6 \strokec6 +\cf4 \strokec4  \cf6 \strokec6 1\cf4 \strokec4 \
    \}\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} (lifesign \cf6 \strokec6 !=\cf4 \strokec4  \cf7 \strokec7 "none"\cf4 \strokec4  \cf6 \strokec6 &&\cf4 \strokec4  reached.threshold \cf6 \strokec6 >\cf4 \strokec4  threshold) \{\
        {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/cat.html"}}{\fldrslt \cf5 \strokec5 cat}}(\cf7 \strokec7 "stepmax\\tmin thresh: "\cf4 \strokec4 , min.reached.threshold, \cf7 \strokec7 "\\n"\cf4 \strokec4 , \
            sep \cf6 \strokec6 =\cf4 \strokec4  \cf7 \strokec7 ""\cf4 \strokec4 )\
    \}\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/function.html"}}{\fldrslt \cf5 \strokec5 return}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/list.html"}}{\fldrslt \cf5 \strokec5 list}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/weights.html"}}{\fldrslt \cf5 \strokec5 weights}} \cf6 \strokec6 =\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/weights.html"}}{\fldrslt \cf5 \strokec5 weights}}, {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/step.html"}}{\fldrslt \cf5 \strokec5 step}} \cf6 \strokec6 =\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/integer.html"}}{\fldrslt \cf5 \strokec5 as.integer}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/step.html"}}{\fldrslt \cf5 \strokec5 step}}), reached.threshold \cf6 \strokec6 =\cf4 \strokec4  reached.threshold, \
        net.result \cf6 \strokec6 =\cf4 \strokec4  result\cf6 \strokec6 $\cf4 \strokec4 net.result, neuron.deriv \cf6 \strokec6 =\cf4 \strokec4  result\cf6 \strokec6 $\cf4 \strokec4 neuron.deriv))\
\}\
\pard\pardeftab720\sl340\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://rdrr.io/cran/neuralnet/src/R/neuralnet.r"}}{\fldrslt \cf5 \strokec5 compute.net}} \cf6 \strokec6 <-\cf4 \strokec4 \
\pard\pardeftab720\sl340\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/function.html"}}{\fldrslt \cf5 \strokec5 function}} ({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/weights.html"}}{\fldrslt \cf5 \strokec5 weights}}, length.weights, covariate, act.fct, act.deriv.fct, \
    output.act.fct, output.act.deriv.fct, special) \
\{\
    neuron.deriv \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/NULL.html"}}{\fldrslt \cf5 \strokec5 NULL}}\
    neurons \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/list.html"}}{\fldrslt \cf5 \strokec5 list}}(covariate)\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} (length.weights \cf6 \strokec6 >\cf4 \strokec4  \cf6 \strokec6 1\cf4 \strokec4 ) \
        {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 for}} (i {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 in}} \cf6 \strokec6 1:\cf4 \strokec4 (length.weights \cf6 \strokec6 -\cf4 \strokec4  \cf6 \strokec6 1\cf4 \strokec4 )) \{\
            temp \cf6 \strokec6 <-\cf4 \strokec4  neurons[[i]] \cf6 \strokec6 %*%\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/weights.html"}}{\fldrslt \cf5 \strokec5 weights}}[[i]]\
            act.temp \cf6 \strokec6 <-\cf4 \strokec4  act.fct(temp)\
            {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} (special) \
                neuron.deriv[[i]] \cf6 \strokec6 <-\cf4 \strokec4  act.deriv.fct(act.temp)\
            {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 else}} neuron.deriv[[i]] \cf6 \strokec6 <-\cf4 \strokec4  act.deriv.fct(temp)\
            neurons[[i \cf6 \strokec6 +\cf4 \strokec4  \cf6 \strokec6 1\cf4 \strokec4 ]] \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/cbind.html"}}{\fldrslt \cf5 \strokec5 cbind}}(\cf6 \strokec6 1\cf4 \strokec4 , act.temp)\
        \}\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} (\cf6 \strokec6 !{\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/list.html"}}{\fldrslt \cf5 \strokec5 is.list}}\cf4 \strokec4 (neuron.deriv)) \
        neuron.deriv \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/list.html"}}{\fldrslt \cf5 \strokec5 list}}(neuron.deriv)\
    temp \cf6 \strokec6 <-\cf4 \strokec4  neurons[[length.weights]] \cf6 \strokec6 %*%\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/weights.html"}}{\fldrslt \cf5 \strokec5 weights}}[[length.weights]]\
    net.result \cf6 \strokec6 <-\cf4 \strokec4  output.act.fct(temp)\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} (special) \
        neuron.deriv[[length.weights]] \cf6 \strokec6 <-\cf4 \strokec4  output.act.deriv.fct(net.result)\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 else}} neuron.deriv[[length.weights]] \cf6 \strokec6 <-\cf4 \strokec4  output.act.deriv.fct(temp)\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} ({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/any.html"}}{\fldrslt \cf5 \strokec5 any}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/NA.html"}}{\fldrslt \cf5 \strokec5 is.na}}(neuron.deriv))) \
        {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/stop.html"}}{\fldrslt \cf5 \strokec5 stop}}(\cf7 \strokec7 "neuron derivatives contain a NA; varify that the derivative function does not divide by 0"\cf4 \strokec4 , \
            call. \cf6 \strokec6 =\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/logical.html"}}{\fldrslt \cf5 \strokec5 FALSE}})\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/list.html"}}{\fldrslt \cf5 \strokec5 list}}(neurons \cf6 \strokec6 =\cf4 \strokec4  neurons, neuron.deriv \cf6 \strokec6 =\cf4 \strokec4  neuron.deriv, net.result \cf6 \strokec6 =\cf4 \strokec4  net.result)\
\}\
\pard\pardeftab720\sl340\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://rdrr.io/cran/neuralnet/src/R/neuralnet.r"}}{\fldrslt \cf5 \strokec5 calculate.gradients}} \cf6 \strokec6 <-\cf4 \strokec4 \
\pard\pardeftab720\sl340\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/function.html"}}{\fldrslt \cf5 \strokec5 function}} ({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/weights.html"}}{\fldrslt \cf5 \strokec5 weights}}, length.weights, neurons, neuron.deriv, err.deriv, \
    exclude, linear.output) \
\{\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} ({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/any.html"}}{\fldrslt \cf5 \strokec5 any}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/NA.html"}}{\fldrslt \cf5 \strokec5 is.na}}(err.deriv))) \
        {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/stop.html"}}{\fldrslt \cf5 \strokec5 stop}}(\cf7 \strokec7 "the error derivative contains a NA; varify that the derivative function does not divide by 0 (e.g. cross entropy)"\cf4 \strokec4 , \
            call. \cf6 \strokec6 =\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/logical.html"}}{\fldrslt \cf5 \strokec5 FALSE}})\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} (\cf6 \strokec6 !\cf4 \strokec4 linear.output) \
        delta \cf6 \strokec6 <-\cf4 \strokec4  neuron.deriv[[length.weights]] \cf6 \strokec6 *\cf4 \strokec4  err.deriv\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 else}} delta \cf6 \strokec6 <-\cf4 \strokec4  err.deriv\
    gradients \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/crossprod.html"}}{\fldrslt \cf5 \strokec5 crossprod}}(neurons[[length.weights]], delta)\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} (length.weights \cf6 \strokec6 >\cf4 \strokec4  \cf6 \strokec6 1\cf4 \strokec4 ) \
        {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 for}} (w {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 in}} (length.weights \cf6 \strokec6 -\cf4 \strokec4  \cf6 \strokec6 1\cf4 \strokec4 )\cf6 \strokec6 :1\cf4 \strokec4 ) \{\
            delta \cf6 \strokec6 <-\cf4 \strokec4  neuron.deriv[[w]] \cf6 \strokec6 *\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/crossprod.html"}}{\fldrslt \cf5 \strokec5 tcrossprod}}(delta, {\field{\*\fldinst{HYPERLINK "https://rdrr.io/cran/neuralnet/src/R/neuralnet.r"}}{\fldrslt \cf5 \strokec5 remove.intercept}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/weights.html"}}{\fldrslt \cf5 \strokec5 weights}}[[w \cf6 \strokec6 +\cf4 \strokec4  \
                \cf6 \strokec6 1\cf4 \strokec4 ]]))\
            gradients \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/c.html"}}{\fldrslt \cf5 \strokec5 c}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/crossprod.html"}}{\fldrslt \cf5 \strokec5 crossprod}}(neurons[[w]], delta), gradients)\
        \}\
    gradients[\cf6 \strokec6 -\cf4 \strokec4 exclude]\
\}\
\pard\pardeftab720\sl340\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://rdrr.io/cran/neuralnet/src/R/neuralnet.r"}}{\fldrslt \cf5 \strokec5 plus}} \cf6 \strokec6 <-\cf4 \strokec4 \
\pard\pardeftab720\sl340\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/function.html"}}{\fldrslt \cf5 \strokec5 function}} (gradients, gradients.old, {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/weights.html"}}{\fldrslt \cf5 \strokec5 weights}}, nrow.weights, ncol.weights, \
    learningrate, learningrate.factor, learningrate.limit, exclude) \
\{\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/weights.html"}}{\fldrslt \cf5 \strokec5 weights}} \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/unlist.html"}}{\fldrslt \cf5 \strokec5 unlist}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/weights.html"}}{\fldrslt \cf5 \strokec5 weights}})\
    sign.gradient \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/sign.html"}}{\fldrslt \cf5 \strokec5 sign}}(gradients)\
    temp \cf6 \strokec6 <-\cf4 \strokec4  gradients.old \cf6 \strokec6 *\cf4 \strokec4  sign.gradient\
    positive \cf6 \strokec6 <-\cf4 \strokec4  temp \cf6 \strokec6 >\cf4 \strokec4  \cf6 \strokec6 0\cf4 \strokec4 \
    negative \cf6 \strokec6 <-\cf4 \strokec4  temp \cf6 \strokec6 <\cf4 \strokec4  \cf6 \strokec6 0\cf4 \strokec4 \
    not.negative \cf6 \strokec6 <-\cf4 \strokec4  \cf6 \strokec6 !\cf4 \strokec4 negative\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} ({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/any.html"}}{\fldrslt \cf5 \strokec5 any}}(positive)) \{\
        learningrate[positive] \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Extremes.html"}}{\fldrslt \cf5 \strokec5 pmin.int}}(learningrate[positive] \cf6 \strokec6 *\cf4 \strokec4  \
            learningrate.factor\cf6 \strokec6 ${\field{\*\fldinst{HYPERLINK "https://rdrr.io/cran/neuralnet/src/R/neuralnet.r"}}{\fldrslt \cf5 \strokec5 plus}}\cf4 \strokec4 , learningrate.limit\cf6 \strokec6 ${\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Extremes.html"}}{\fldrslt \cf5 \strokec5 max}}\cf4 \strokec4 )\
    \}\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} ({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/any.html"}}{\fldrslt \cf5 \strokec5 any}}(negative)) \{\
        {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/weights.html"}}{\fldrslt \cf5 \strokec5 weights}}[\cf6 \strokec6 -\cf4 \strokec4 exclude][negative] \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/weights.html"}}{\fldrslt \cf5 \strokec5 weights}}[\cf6 \strokec6 -\cf4 \strokec4 exclude][negative] \cf6 \strokec6 +\cf4 \strokec4  \
            gradients.old[negative] \cf6 \strokec6 *\cf4 \strokec4  learningrate[negative]\
        learningrate[negative] \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Extremes.html"}}{\fldrslt \cf5 \strokec5 pmax.int}}(learningrate[negative] \cf6 \strokec6 *\cf4 \strokec4  \
            learningrate.factor\cf6 \strokec6 ${\field{\*\fldinst{HYPERLINK "https://rdrr.io/cran/neuralnet/src/R/neuralnet.r"}}{\fldrslt \cf5 \strokec5 minus}}\cf4 \strokec4 , learningrate.limit\cf6 \strokec6 ${\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Extremes.html"}}{\fldrslt \cf5 \strokec5 min}}\cf4 \strokec4 )\
        gradients.old[negative] \cf6 \strokec6 <-\cf4 \strokec4  \cf6 \strokec6 0\cf4 \strokec4 \
        {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} ({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/any.html"}}{\fldrslt \cf5 \strokec5 any}}(not.negative)) \{\
            {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/weights.html"}}{\fldrslt \cf5 \strokec5 weights}}[\cf6 \strokec6 -\cf4 \strokec4 exclude][not.negative] \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/weights.html"}}{\fldrslt \cf5 \strokec5 weights}}[\cf6 \strokec6 -\cf4 \strokec4 exclude][not.negative] \cf6 \strokec6 -\cf4 \strokec4  \
                sign.gradient[not.negative] \cf6 \strokec6 *\cf4 \strokec4  learningrate[not.negative]\
            gradients.old[not.negative] \cf6 \strokec6 <-\cf4 \strokec4  sign.gradient[not.negative]\
        \}\
    \}\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 else}} \{\
        {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/weights.html"}}{\fldrslt \cf5 \strokec5 weights}}[\cf6 \strokec6 -\cf4 \strokec4 exclude] \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/weights.html"}}{\fldrslt \cf5 \strokec5 weights}}[\cf6 \strokec6 -\cf4 \strokec4 exclude] \cf6 \strokec6 -\cf4 \strokec4  sign.gradient \cf6 \strokec6 *\cf4 \strokec4  \
            learningrate\
        gradients.old \cf6 \strokec6 <-\cf4 \strokec4  sign.gradient\
    \}\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/list.html"}}{\fldrslt \cf5 \strokec5 list}}(gradients.old \cf6 \strokec6 =\cf4 \strokec4  gradients.old, {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/weights.html"}}{\fldrslt \cf5 \strokec5 weights}} \cf6 \strokec6 =\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/utils/relist.html"}}{\fldrslt \cf5 \strokec5 relist}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/weights.html"}}{\fldrslt \cf5 \strokec5 weights}}, \
        nrow.weights, ncol.weights), learningrate \cf6 \strokec6 =\cf4 \strokec4  learningrate)\
\}\
\pard\pardeftab720\sl340\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://rdrr.io/cran/neuralnet/src/R/neuralnet.r"}}{\fldrslt \cf5 \strokec5 backprop}} \cf6 \strokec6 <-\cf4 \strokec4 \
\pard\pardeftab720\sl340\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/function.html"}}{\fldrslt \cf5 \strokec5 function}} (gradients, {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/weights.html"}}{\fldrslt \cf5 \strokec5 weights}}, length.weights, nrow.weights, ncol.weights, \
    learningrate.bp, exclude) \
\{\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/weights.html"}}{\fldrslt \cf5 \strokec5 weights}} \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/unlist.html"}}{\fldrslt \cf5 \strokec5 unlist}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/weights.html"}}{\fldrslt \cf5 \strokec5 weights}})\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} (\cf6 \strokec6 !{\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/NULL.html"}}{\fldrslt \cf5 \strokec5 is.null}}\cf4 \strokec4 (exclude)) \
        {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/weights.html"}}{\fldrslt \cf5 \strokec5 weights}}[\cf6 \strokec6 -\cf4 \strokec4 exclude] \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/weights.html"}}{\fldrslt \cf5 \strokec5 weights}}[\cf6 \strokec6 -\cf4 \strokec4 exclude] \cf6 \strokec6 -\cf4 \strokec4  gradients \cf6 \strokec6 *\cf4 \strokec4  \
            learningrate.bp\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 else}} {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/weights.html"}}{\fldrslt \cf5 \strokec5 weights}} \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/weights.html"}}{\fldrslt \cf5 \strokec5 weights}} \cf6 \strokec6 -\cf4 \strokec4  gradients \cf6 \strokec6 *\cf4 \strokec4  learningrate.bp\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/list.html"}}{\fldrslt \cf5 \strokec5 list}}(gradients.old \cf6 \strokec6 =\cf4 \strokec4  gradients, {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/weights.html"}}{\fldrslt \cf5 \strokec5 weights}} \cf6 \strokec6 =\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/utils/relist.html"}}{\fldrslt \cf5 \strokec5 relist}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/weights.html"}}{\fldrslt \cf5 \strokec5 weights}}, \
        nrow.weights, ncol.weights), learningrate \cf6 \strokec6 =\cf4 \strokec4  learningrate.bp)\
\}\
\pard\pardeftab720\sl340\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://rdrr.io/cran/neuralnet/src/R/neuralnet.r"}}{\fldrslt \cf5 \strokec5 minus}} \cf6 \strokec6 <-\cf4 \strokec4 \
\pard\pardeftab720\sl340\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/function.html"}}{\fldrslt \cf5 \strokec5 function}} (gradients, gradients.old, {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/weights.html"}}{\fldrslt \cf5 \strokec5 weights}}, length.weights, \
    nrow.weights, ncol.weights, learningrate, learningrate.factor, \
    learningrate.limit, algorithm, exclude) \
\{\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/weights.html"}}{\fldrslt \cf5 \strokec5 weights}} \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/unlist.html"}}{\fldrslt \cf5 \strokec5 unlist}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/weights.html"}}{\fldrslt \cf5 \strokec5 weights}})\
    temp \cf6 \strokec6 <-\cf4 \strokec4  gradients.old \cf6 \strokec6 *\cf4 \strokec4  gradients\
    positive \cf6 \strokec6 <-\cf4 \strokec4  temp \cf6 \strokec6 >\cf4 \strokec4  \cf6 \strokec6 0\cf4 \strokec4 \
    negative \cf6 \strokec6 <-\cf4 \strokec4  temp \cf6 \strokec6 <\cf4 \strokec4  \cf6 \strokec6 0\cf4 \strokec4 \
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} ({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/any.html"}}{\fldrslt \cf5 \strokec5 any}}(positive)) \
        learningrate[positive] \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Extremes.html"}}{\fldrslt \cf5 \strokec5 pmin.int}}(learningrate[positive] \cf6 \strokec6 *\cf4 \strokec4  \
            learningrate.factor\cf6 \strokec6 ${\field{\*\fldinst{HYPERLINK "https://rdrr.io/cran/neuralnet/src/R/neuralnet.r"}}{\fldrslt \cf5 \strokec5 plus}}\cf4 \strokec4 , learningrate.limit\cf6 \strokec6 ${\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Extremes.html"}}{\fldrslt \cf5 \strokec5 max}}\cf4 \strokec4 )\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} ({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/any.html"}}{\fldrslt \cf5 \strokec5 any}}(negative)) \
        learningrate[negative] \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Extremes.html"}}{\fldrslt \cf5 \strokec5 pmax.int}}(learningrate[negative] \cf6 \strokec6 *\cf4 \strokec4  \
            learningrate.factor\cf6 \strokec6 ${\field{\*\fldinst{HYPERLINK "https://rdrr.io/cran/neuralnet/src/R/neuralnet.r"}}{\fldrslt \cf5 \strokec5 minus}}\cf4 \strokec4 , learningrate.limit\cf6 \strokec6 ${\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Extremes.html"}}{\fldrslt \cf5 \strokec5 min}}\cf4 \strokec4 )\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} (algorithm \cf6 \strokec6 !=\cf4 \strokec4  \cf7 \strokec7 "rprop-"\cf4 \strokec4 ) \{\
        delta \cf6 \strokec6 <-\cf4 \strokec4  \cf6 \strokec6 10^-6\cf4 \strokec4 \
        notzero \cf6 \strokec6 <-\cf4 \strokec4  gradients \cf6 \strokec6 !=\cf4 \strokec4  \cf6 \strokec6 0\cf4 \strokec4 \
        gradients.notzero \cf6 \strokec6 <-\cf4 \strokec4  gradients[notzero]\
        {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} (algorithm \cf6 \strokec6 ==\cf4 \strokec4  \cf7 \strokec7 "slr"\cf4 \strokec4 ) \{\
            {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Extremes.html"}}{\fldrslt \cf5 \strokec5 min}} \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/which.min.html"}}{\fldrslt \cf5 \strokec5 which.min}}(learningrate[notzero])\
        \}\
        {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 else}} {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} (algorithm \cf6 \strokec6 ==\cf4 \strokec4  \cf7 \strokec7 "sag"\cf4 \strokec4 ) \{\
            {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Extremes.html"}}{\fldrslt \cf5 \strokec5 min}} \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/which.min.html"}}{\fldrslt \cf5 \strokec5 which.min}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/MathFun.html"}}{\fldrslt \cf5 \strokec5 abs}}(gradients.notzero))\
        \}\
        {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} ({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/length.html"}}{\fldrslt \cf5 \strokec5 length}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Extremes.html"}}{\fldrslt \cf5 \strokec5 min}}) \cf6 \strokec6 !=\cf4 \strokec4  \cf6 \strokec6 0\cf4 \strokec4 ) \{\
            temp \cf6 \strokec6 <-\cf4 \strokec4  learningrate[notzero] \cf6 \strokec6 *\cf4 \strokec4  gradients.notzero\
            {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/sum.html"}}{\fldrslt \cf5 \strokec5 sum}} \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/sum.html"}}{\fldrslt \cf5 \strokec5 sum}}(temp[\cf6 \strokec6 -{\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Extremes.html"}}{\fldrslt \cf5 \strokec5 min}}\cf4 \strokec4 ]) \cf6 \strokec6 +\cf4 \strokec4  delta\
            learningrate[notzero][{\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Extremes.html"}}{\fldrslt \cf5 \strokec5 min}}] \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Extremes.html"}}{\fldrslt \cf5 \strokec5 min}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Extremes.html"}}{\fldrslt \cf5 \strokec5 max}}(\cf6 \strokec6 -{\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/sum.html"}}{\fldrslt \cf5 \strokec5 sum}}/\cf4 \strokec4 gradients.notzero[{\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Extremes.html"}}{\fldrslt \cf5 \strokec5 min}}], \
                learningrate.limit\cf6 \strokec6 ${\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Extremes.html"}}{\fldrslt \cf5 \strokec5 min}}\cf4 \strokec4 ), learningrate.limit\cf6 \strokec6 ${\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Extremes.html"}}{\fldrslt \cf5 \strokec5 max}}\cf4 \strokec4 )\
        \}\
    \}\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/weights.html"}}{\fldrslt \cf5 \strokec5 weights}}[\cf6 \strokec6 -\cf4 \strokec4 exclude] \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/weights.html"}}{\fldrslt \cf5 \strokec5 weights}}[\cf6 \strokec6 -\cf4 \strokec4 exclude] \cf6 \strokec6 -\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/sign.html"}}{\fldrslt \cf5 \strokec5 sign}}(gradients) \cf6 \strokec6 *\cf4 \strokec4  \
        learningrate\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/list.html"}}{\fldrslt \cf5 \strokec5 list}}(gradients.old \cf6 \strokec6 =\cf4 \strokec4  gradients, {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/weights.html"}}{\fldrslt \cf5 \strokec5 weights}} \cf6 \strokec6 =\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/utils/relist.html"}}{\fldrslt \cf5 \strokec5 relist}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/weights.html"}}{\fldrslt \cf5 \strokec5 weights}}, \
        nrow.weights, ncol.weights), learningrate \cf6 \strokec6 =\cf4 \strokec4  learningrate)\
\}\
\pard\pardeftab720\sl340\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://rdrr.io/cran/neuralnet/src/R/neuralnet.r"}}{\fldrslt \cf5 \strokec5 calculate.generalized.weights}} \cf6 \strokec6 <-\cf4 \strokec4 \
\pard\pardeftab720\sl340\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/function.html"}}{\fldrslt \cf5 \strokec5 function}} ({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/weights.html"}}{\fldrslt \cf5 \strokec5 weights}}, neuron.deriv, net.result) \
\{\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 for}} (w {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 in}} \cf6 \strokec6 1:{\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/length.html"}}{\fldrslt \cf5 \strokec5 length}}\cf4 \strokec4 ({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/weights.html"}}{\fldrslt \cf5 \strokec5 weights}})) \{\
        {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/weights.html"}}{\fldrslt \cf5 \strokec5 weights}}[[w]] \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/cran/neuralnet/src/R/neuralnet.r"}}{\fldrslt \cf5 \strokec5 remove.intercept}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/weights.html"}}{\fldrslt \cf5 \strokec5 weights}}[[w]])\
    \}\
    generalized.weights \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/NULL.html"}}{\fldrslt \cf5 \strokec5 NULL}}\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 for}} (k {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 in}} \cf6 \strokec6 1:{\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/nrow.html"}}{\fldrslt \cf5 \strokec5 ncol}}\cf4 \strokec4 (net.result)) \{\
        {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 for}} (w {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 in}} {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/length.html"}}{\fldrslt \cf5 \strokec5 length}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/weights.html"}}{\fldrslt \cf5 \strokec5 weights}})\cf6 \strokec6 :1\cf4 \strokec4 ) \{\
            {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} (w \cf6 \strokec6 ==\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/length.html"}}{\fldrslt \cf5 \strokec5 length}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/weights.html"}}{\fldrslt \cf5 \strokec5 weights}})) \{\
                temp \cf6 \strokec6 <-\cf4 \strokec4  neuron.deriv[[{\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/length.html"}}{\fldrslt \cf5 \strokec5 length}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/weights.html"}}{\fldrslt \cf5 \strokec5 weights}})]][, k] \cf6 \strokec6 *\cf4 \strokec4  \
                  \cf6 \strokec6 1/\cf4 \strokec4 (net.result[, k] \cf6 \strokec6 *\cf4 \strokec4  (\cf6 \strokec6 1\cf4 \strokec4  \cf6 \strokec6 -\cf4 \strokec4  (net.result[, k])))\
                delta \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/crossprod.html"}}{\fldrslt \cf5 \strokec5 tcrossprod}}(temp, {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/weights.html"}}{\fldrslt \cf5 \strokec5 weights}}[[w]][, k])\
            \}\
            {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 else}} \{\
                delta \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/crossprod.html"}}{\fldrslt \cf5 \strokec5 tcrossprod}}(delta \cf6 \strokec6 *\cf4 \strokec4  neuron.deriv[[w]], \
                  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/weights.html"}}{\fldrslt \cf5 \strokec5 weights}}[[w]])\
            \}\
        \}\
        generalized.weights \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/cbind.html"}}{\fldrslt \cf5 \strokec5 cbind}}(generalized.weights, delta)\
    \}\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/function.html"}}{\fldrslt \cf5 \strokec5 return}}(generalized.weights)\
\}\
\pard\pardeftab720\sl340\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://rdrr.io/cran/neuralnet/src/R/neuralnet.r"}}{\fldrslt \cf5 \strokec5 generate.output}} \cf6 \strokec6 <-\cf4 \strokec4 \
\pard\pardeftab720\sl340\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/function.html"}}{\fldrslt \cf5 \strokec5 function}} (covariate, {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/call.html"}}{\fldrslt \cf5 \strokec5 call}}, {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/rep.html"}}{\fldrslt \cf5 \strokec5 rep}}, threshold, {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/matrix.html"}}{\fldrslt \cf5 \strokec5 matrix}}, startweights, \
    model.list, response, err.fct, act.fct, {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/utils/data.html"}}{\fldrslt \cf5 \strokec5 data}}, list.result, \
    linear.output, exclude) \
\{\
    covariate \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/t.html"}}{\fldrslt \cf5 \strokec5 t}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/cran/neuralnet/src/R/neuralnet.r"}}{\fldrslt \cf5 \strokec5 remove.intercept}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/t.html"}}{\fldrslt \cf5 \strokec5 t}}(covariate)))\
    nn \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/list.html"}}{\fldrslt \cf5 \strokec5 list}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/call.html"}}{\fldrslt \cf5 \strokec5 call}} \cf6 \strokec6 =\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/call.html"}}{\fldrslt \cf5 \strokec5 call}})\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/class.html"}}{\fldrslt \cf5 \strokec5 class}}(nn) \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/c.html"}}{\fldrslt \cf5 \strokec5 c}}(\cf7 \strokec7 "nn"\cf4 \strokec4 )\
    nn\cf6 \strokec6 $\cf4 \strokec4 response \cf6 \strokec6 <-\cf4 \strokec4  response\
    nn\cf6 \strokec6 $\cf4 \strokec4 covariate \cf6 \strokec6 <-\cf4 \strokec4  covariate\
    nn\cf6 \strokec6 $\cf4 \strokec4 model.list \cf6 \strokec6 <-\cf4 \strokec4  model.list\
    nn\cf6 \strokec6 $\cf4 \strokec4 err.fct \cf6 \strokec6 <-\cf4 \strokec4  err.fct\
    nn\cf6 \strokec6 $\cf4 \strokec4 act.fct \cf6 \strokec6 <-\cf4 \strokec4  act.fct\
    nn\cf6 \strokec6 $\cf4 \strokec4 linear.output \cf6 \strokec6 <-\cf4 \strokec4  linear.output\
    nn\cf6 \strokec6 ${\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/utils/data.html"}}{\fldrslt \cf5 \strokec5 data}}\cf4 \strokec4  \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/utils/data.html"}}{\fldrslt \cf5 \strokec5 data}}\
    nn\cf6 \strokec6 $\cf4 \strokec4 exclude \cf6 \strokec6 <-\cf4 \strokec4  exclude\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} (\cf6 \strokec6 !{\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/NULL.html"}}{\fldrslt \cf5 \strokec5 is.null}}\cf4 \strokec4 ({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/matrix.html"}}{\fldrslt \cf5 \strokec5 matrix}})) \{\
        nn\cf6 \strokec6 $\cf4 \strokec4 net.result \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/NULL.html"}}{\fldrslt \cf5 \strokec5 NULL}}\
        nn\cf6 \strokec6 ${\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/weights.html"}}{\fldrslt \cf5 \strokec5 weights}}\cf4 \strokec4  \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/NULL.html"}}{\fldrslt \cf5 \strokec5 NULL}}\
        nn\cf6 \strokec6 $\cf4 \strokec4 generalized.weights \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/NULL.html"}}{\fldrslt \cf5 \strokec5 NULL}}\
        nn\cf6 \strokec6 $\cf4 \strokec4 startweights \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/NULL.html"}}{\fldrslt \cf5 \strokec5 NULL}}\
        {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 for}} (i {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 in}} \cf6 \strokec6 1:{\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/length.html"}}{\fldrslt \cf5 \strokec5 length}}\cf4 \strokec4 (list.result)) \{\
            nn\cf6 \strokec6 $\cf4 \strokec4 net.result \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/c.html"}}{\fldrslt \cf5 \strokec5 c}}(nn\cf6 \strokec6 $\cf4 \strokec4 net.result, {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/list.html"}}{\fldrslt \cf5 \strokec5 list}}(list.result[[i]]\cf6 \strokec6 $\cf4 \strokec4 net.result))\
            nn\cf6 \strokec6 ${\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/weights.html"}}{\fldrslt \cf5 \strokec5 weights}}\cf4 \strokec4  \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/c.html"}}{\fldrslt \cf5 \strokec5 c}}(nn\cf6 \strokec6 ${\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/weights.html"}}{\fldrslt \cf5 \strokec5 weights}}\cf4 \strokec4 , {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/list.html"}}{\fldrslt \cf5 \strokec5 list}}(list.result[[i]]\cf6 \strokec6 ${\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/weights.html"}}{\fldrslt \cf5 \strokec5 weights}}\cf4 \strokec4 ))\
            nn\cf6 \strokec6 $\cf4 \strokec4 startweights \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/c.html"}}{\fldrslt \cf5 \strokec5 c}}(nn\cf6 \strokec6 $\cf4 \strokec4 startweights, {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/list.html"}}{\fldrslt \cf5 \strokec5 list}}(list.result[[i]]\cf6 \strokec6 $\cf4 \strokec4 startweights))\
            nn\cf6 \strokec6 $\cf4 \strokec4 generalized.weights \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/c.html"}}{\fldrslt \cf5 \strokec5 c}}(nn\cf6 \strokec6 $\cf4 \strokec4 generalized.weights, \
                {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/list.html"}}{\fldrslt \cf5 \strokec5 list}}(list.result[[i]]\cf6 \strokec6 $\cf4 \strokec4 generalized.weights))\
        \}\
        nn\cf6 \strokec6 $\cf4 \strokec4 result.matrix \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/cran/neuralnet/src/R/neuralnet.r"}}{\fldrslt \cf5 \strokec5 generate.rownames}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/matrix.html"}}{\fldrslt \cf5 \strokec5 matrix}}, nn\cf6 \strokec6 ${\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/weights.html"}}{\fldrslt \cf5 \strokec5 weights}}\cf4 \strokec4 [[\cf6 \strokec6 1\cf4 \strokec4 ]], \
            model.list)\
    \}\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/function.html"}}{\fldrslt \cf5 \strokec5 return}}(nn)\
\}\
\pard\pardeftab720\sl340\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://rdrr.io/cran/neuralnet/src/R/neuralnet.r"}}{\fldrslt \cf5 \strokec5 generate.rownames}} \cf6 \strokec6 <-\cf4 \strokec4 \
\pard\pardeftab720\sl340\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/function.html"}}{\fldrslt \cf5 \strokec5 function}} ({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/matrix.html"}}{\fldrslt \cf5 \strokec5 matrix}}, {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/weights.html"}}{\fldrslt \cf5 \strokec5 weights}}, model.list) \
\{\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/colnames.html"}}{\fldrslt \cf5 \strokec5 rownames}} \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/colnames.html"}}{\fldrslt \cf5 \strokec5 rownames}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/matrix.html"}}{\fldrslt \cf5 \strokec5 matrix}})[{\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/colnames.html"}}{\fldrslt \cf5 \strokec5 rownames}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/matrix.html"}}{\fldrslt \cf5 \strokec5 matrix}}) \cf6 \strokec6 !=\cf4 \strokec4  \cf7 \strokec7 ""\cf4 \strokec4 ]\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 for}} (w {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 in}} \cf6 \strokec6 1:{\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/length.html"}}{\fldrslt \cf5 \strokec5 length}}\cf4 \strokec4 ({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/weights.html"}}{\fldrslt \cf5 \strokec5 weights}})) \{\
        {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 for}} (j {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 in}} \cf6 \strokec6 1:{\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/nrow.html"}}{\fldrslt \cf5 \strokec5 ncol}}\cf4 \strokec4 ({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/weights.html"}}{\fldrslt \cf5 \strokec5 weights}}[[w]])) \{\
            {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 for}} (i {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 in}} \cf6 \strokec6 1:{\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/nrow.html"}}{\fldrslt \cf5 \strokec5 nrow}}\cf4 \strokec4 ({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/weights.html"}}{\fldrslt \cf5 \strokec5 weights}}[[w]])) \{\
                {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} (i \cf6 \strokec6 ==\cf4 \strokec4  \cf6 \strokec6 1\cf4 \strokec4 ) \{\
                  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} (w \cf6 \strokec6 ==\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/length.html"}}{\fldrslt \cf5 \strokec5 length}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/weights.html"}}{\fldrslt \cf5 \strokec5 weights}})) \{\
                    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/colnames.html"}}{\fldrslt \cf5 \strokec5 rownames}} \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/c.html"}}{\fldrslt \cf5 \strokec5 c}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/colnames.html"}}{\fldrslt \cf5 \strokec5 rownames}}, {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/paste.html"}}{\fldrslt \cf5 \strokec5 paste}}(\cf7 \strokec7 "Intercept.to."\cf4 \strokec4 , \
                      model.list\cf6 \strokec6 $\cf4 \strokec4 response[j], sep \cf6 \strokec6 =\cf4 \strokec4  \cf7 \strokec7 ""\cf4 \strokec4 ))\
                  \}\
                  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 else}} \{\
                    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/colnames.html"}}{\fldrslt \cf5 \strokec5 rownames}} \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/c.html"}}{\fldrslt \cf5 \strokec5 c}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/colnames.html"}}{\fldrslt \cf5 \strokec5 rownames}}, {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/paste.html"}}{\fldrslt \cf5 \strokec5 paste}}(\cf7 \strokec7 "Intercept.to."\cf4 \strokec4 , \
                      w, \cf7 \strokec7 "layhid"\cf4 \strokec4 , j, sep \cf6 \strokec6 =\cf4 \strokec4  \cf7 \strokec7 ""\cf4 \strokec4 ))\
                  \}\
                \}\
                {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 else}} \{\
                  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} (w \cf6 \strokec6 ==\cf4 \strokec4  \cf6 \strokec6 1\cf4 \strokec4 ) \{\
                    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} (w \cf6 \strokec6 ==\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/length.html"}}{\fldrslt \cf5 \strokec5 length}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/weights.html"}}{\fldrslt \cf5 \strokec5 weights}})) \{\
                      {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/colnames.html"}}{\fldrslt \cf5 \strokec5 rownames}} \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/c.html"}}{\fldrslt \cf5 \strokec5 c}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/colnames.html"}}{\fldrslt \cf5 \strokec5 rownames}}, {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/paste.html"}}{\fldrslt \cf5 \strokec5 paste}}(model.list\cf6 \strokec6 $\cf4 \strokec4 variables[i \cf6 \strokec6 -\cf4 \strokec4  \
                        \cf6 \strokec6 1\cf4 \strokec4 ], \cf7 \strokec7 ".to."\cf4 \strokec4 , model.list\cf6 \strokec6 $\cf4 \strokec4 response[j], sep \cf6 \strokec6 =\cf4 \strokec4  \cf7 \strokec7 ""\cf4 \strokec4 ))\
                    \}\
                    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 else}} \{\
                      {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/colnames.html"}}{\fldrslt \cf5 \strokec5 rownames}} \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/c.html"}}{\fldrslt \cf5 \strokec5 c}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/colnames.html"}}{\fldrslt \cf5 \strokec5 rownames}}, {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/paste.html"}}{\fldrslt \cf5 \strokec5 paste}}(model.list\cf6 \strokec6 $\cf4 \strokec4 variables[i \cf6 \strokec6 -\cf4 \strokec4  \
                        \cf6 \strokec6 1\cf4 \strokec4 ], \cf7 \strokec7 ".to.1layhid"\cf4 \strokec4 , j, sep \cf6 \strokec6 =\cf4 \strokec4  \cf7 \strokec7 ""\cf4 \strokec4 ))\
                    \}\
                  \}\
                  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 else}} \{\
                    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} (w \cf6 \strokec6 ==\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/length.html"}}{\fldrslt \cf5 \strokec5 length}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/weights.html"}}{\fldrslt \cf5 \strokec5 weights}})) \{\
                      {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/colnames.html"}}{\fldrslt \cf5 \strokec5 rownames}} \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/c.html"}}{\fldrslt \cf5 \strokec5 c}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/colnames.html"}}{\fldrslt \cf5 \strokec5 rownames}}, {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/paste.html"}}{\fldrslt \cf5 \strokec5 paste}}(w \cf6 \strokec6 -\cf4 \strokec4  \cf6 \strokec6 1\cf4 \strokec4 , \cf7 \strokec7 "layhid."\cf4 \strokec4 , \
                        i \cf6 \strokec6 -\cf4 \strokec4  \cf6 \strokec6 1\cf4 \strokec4 , \cf7 \strokec7 ".to."\cf4 \strokec4 , model.list\cf6 \strokec6 $\cf4 \strokec4 response[j], \
                        sep \cf6 \strokec6 =\cf4 \strokec4  \cf7 \strokec7 ""\cf4 \strokec4 ))\
                    \}\
                    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 else}} \{\
                      {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/colnames.html"}}{\fldrslt \cf5 \strokec5 rownames}} \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/c.html"}}{\fldrslt \cf5 \strokec5 c}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/colnames.html"}}{\fldrslt \cf5 \strokec5 rownames}}, {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/paste.html"}}{\fldrslt \cf5 \strokec5 paste}}(w \cf6 \strokec6 -\cf4 \strokec4  \cf6 \strokec6 1\cf4 \strokec4 , \cf7 \strokec7 "layhid."\cf4 \strokec4 , \
                        i \cf6 \strokec6 -\cf4 \strokec4  \cf6 \strokec6 1\cf4 \strokec4 , \cf7 \strokec7 ".to."\cf4 \strokec4 , w, \cf7 \strokec7 "layhid"\cf4 \strokec4 , j, sep \cf6 \strokec6 =\cf4 \strokec4  \cf7 \strokec7 ""\cf4 \strokec4 ))\
                    \}\
                  \}\
                \}\
            \}\
        \}\
    \}\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/colnames.html"}}{\fldrslt \cf5 \strokec5 rownames}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/matrix.html"}}{\fldrslt \cf5 \strokec5 matrix}}) \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/colnames.html"}}{\fldrslt \cf5 \strokec5 rownames}}\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/colnames.html"}}{\fldrslt \cf5 \strokec5 colnames}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/matrix.html"}}{\fldrslt \cf5 \strokec5 matrix}}) \cf6 \strokec6 <-\cf4 \strokec4  \cf6 \strokec6 1:\cf4 \strokec4 ({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/nrow.html"}}{\fldrslt \cf5 \strokec5 ncol}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/matrix.html"}}{\fldrslt \cf5 \strokec5 matrix}}))\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/function.html"}}{\fldrslt \cf5 \strokec5 return}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/matrix.html"}}{\fldrslt \cf5 \strokec5 matrix}})\
\}\
\pard\pardeftab720\sl340\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/utils/relist.html"}}{\fldrslt \cf5 \strokec5 relist}} \cf6 \strokec6 <-\cf4 \strokec4 \
\pard\pardeftab720\sl340\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/function.html"}}{\fldrslt \cf5 \strokec5 function}} (x, {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/nrow.html"}}{\fldrslt \cf5 \strokec5 nrow}}, {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/nrow.html"}}{\fldrslt \cf5 \strokec5 ncol}}) \
\{\
    list.x \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/NULL.html"}}{\fldrslt \cf5 \strokec5 NULL}}\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 for}} (w {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 in}} \cf6 \strokec6 1:{\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/length.html"}}{\fldrslt \cf5 \strokec5 length}}\cf4 \strokec4 ({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/nrow.html"}}{\fldrslt \cf5 \strokec5 nrow}})) \{\
        {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/length.html"}}{\fldrslt \cf5 \strokec5 length}} \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/nrow.html"}}{\fldrslt \cf5 \strokec5 nrow}}[w] \cf6 \strokec6 *\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/nrow.html"}}{\fldrslt \cf5 \strokec5 ncol}}[w]\
        list.x[[w]] \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/matrix.html"}}{\fldrslt \cf5 \strokec5 matrix}}(x[\cf6 \strokec6 1:{\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/length.html"}}{\fldrslt \cf5 \strokec5 length}}\cf4 \strokec4 ], {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/nrow.html"}}{\fldrslt \cf5 \strokec5 nrow}} \cf6 \strokec6 =\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/nrow.html"}}{\fldrslt \cf5 \strokec5 nrow}}[w], {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/nrow.html"}}{\fldrslt \cf5 \strokec5 ncol}} \cf6 \strokec6 =\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/nrow.html"}}{\fldrslt \cf5 \strokec5 ncol}}[w])\
        x \cf6 \strokec6 <-\cf4 \strokec4  x[\cf6 \strokec6 -\cf4 \strokec4 (\cf6 \strokec6 1:{\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/length.html"}}{\fldrslt \cf5 \strokec5 length}}\cf4 \strokec4 )]\
    \}\
    list.x\
\}\
\pard\pardeftab720\sl340\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://rdrr.io/cran/neuralnet/src/R/neuralnet.r"}}{\fldrslt \cf5 \strokec5 remove.intercept}} \cf6 \strokec6 <-\cf4 \strokec4 \
\pard\pardeftab720\sl340\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/function.html"}}{\fldrslt \cf5 \strokec5 function}} ({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/matrix.html"}}{\fldrslt \cf5 \strokec5 matrix}}) \
\{\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/matrix.html"}}{\fldrslt \cf5 \strokec5 matrix}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/matrix.html"}}{\fldrslt \cf5 \strokec5 matrix}}[\cf6 \strokec6 -1\cf4 \strokec4 , ], {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/nrow.html"}}{\fldrslt \cf5 \strokec5 ncol}} \cf6 \strokec6 =\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/nrow.html"}}{\fldrslt \cf5 \strokec5 ncol}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/matrix.html"}}{\fldrslt \cf5 \strokec5 matrix}}))\
\}\
\pard\pardeftab720\sl340\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/typeof.html"}}{\fldrslt \cf5 \strokec5 type}} \cf6 \strokec6 <-\cf4 \strokec4 \
\pard\pardeftab720\sl340\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/function.html"}}{\fldrslt \cf5 \strokec5 function}} (fct) \
\{\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/attr.html"}}{\fldrslt \cf5 \strokec5 attr}}(fct, \cf7 \strokec7 "type"\cf4 \strokec4 )\
\}\
\pard\pardeftab720\sl340\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://rdrr.io/cran/neuralnet/man/neuralnet.html"}}{\fldrslt \cf5 \strokec5 print.nn}} \cf6 \strokec6 <-\cf4 \strokec4 \
\pard\pardeftab720\sl340\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/function.html"}}{\fldrslt \cf5 \strokec5 function}} (x, {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/dots.html"}}{\fldrslt \cf5 \strokec5 ...}}) \
\{\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/matrix.html"}}{\fldrslt \cf5 \strokec5 matrix}} \cf6 \strokec6 <-\cf4 \strokec4  x\cf6 \strokec6 $\cf4 \strokec4 result.matrix\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/cat.html"}}{\fldrslt \cf5 \strokec5 cat}}(\cf7 \strokec7 "Call: "\cf4 \strokec4 , {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/deparse.html"}}{\fldrslt \cf5 \strokec5 deparse}}(x\cf6 \strokec6 ${\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/call.html"}}{\fldrslt \cf5 \strokec5 call}}\cf4 \strokec4 ), \cf7 \strokec7 "\\n\\n"\cf4 \strokec4 , sep \cf6 \strokec6 =\cf4 \strokec4  \cf7 \strokec7 ""\cf4 \strokec4 )\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} (\cf6 \strokec6 !{\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/NULL.html"}}{\fldrslt \cf5 \strokec5 is.null}}\cf4 \strokec4 ({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/matrix.html"}}{\fldrslt \cf5 \strokec5 matrix}})) \{\
        {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} ({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/nrow.html"}}{\fldrslt \cf5 \strokec5 ncol}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/matrix.html"}}{\fldrslt \cf5 \strokec5 matrix}}) \cf6 \strokec6 >\cf4 \strokec4  \cf6 \strokec6 1\cf4 \strokec4 ) \{\
            {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/cat.html"}}{\fldrslt \cf5 \strokec5 cat}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/nrow.html"}}{\fldrslt \cf5 \strokec5 ncol}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/matrix.html"}}{\fldrslt \cf5 \strokec5 matrix}}), \cf7 \strokec7 " repetitions were calculated.\\n\\n"\cf4 \strokec4 , \
                sep \cf6 \strokec6 =\cf4 \strokec4  \cf7 \strokec7 ""\cf4 \strokec4 )\
            sorted.matrix \cf6 \strokec6 <-\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/matrix.html"}}{\fldrslt \cf5 \strokec5 matrix}}[, {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/order.html"}}{\fldrslt \cf5 \strokec5 order}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/matrix.html"}}{\fldrslt \cf5 \strokec5 matrix}}[\cf7 \strokec7 "error"\cf4 \strokec4 , ])]\
            {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} ({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/any.html"}}{\fldrslt \cf5 \strokec5 any}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/colnames.html"}}{\fldrslt \cf5 \strokec5 rownames}}(sorted.matrix) \cf6 \strokec6 ==\cf4 \strokec4  \cf7 \strokec7 "aic"\cf4 \strokec4 )) \{\
                {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/print.html"}}{\fldrslt \cf5 \strokec5 print}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/t.html"}}{\fldrslt \cf5 \strokec5 t}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/cbind.html"}}{\fldrslt \cf5 \strokec5 rbind}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/aov.html"}}{\fldrslt \cf5 \strokec5 Error}} \cf6 \strokec6 =\cf4 \strokec4  sorted.matrix[\cf7 \strokec7 "error"\cf4 \strokec4 , \
                  ], {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/AIC.html"}}{\fldrslt \cf5 \strokec5 AIC}} \cf6 \strokec6 =\cf4 \strokec4  sorted.matrix[\cf7 \strokec7 "aic"\cf4 \strokec4 , ], {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/AIC.html"}}{\fldrslt \cf5 \strokec5 BIC}} \cf6 \strokec6 =\cf4 \strokec4  sorted.matrix[\cf7 \strokec7 "bic"\cf4 \strokec4 , \
                  ], \cf7 \strokec7 `Reached Threshold`\cf4 \strokec4  \cf6 \strokec6 =\cf4 \strokec4  sorted.matrix[\cf7 \strokec7 "reached.threshold"\cf4 \strokec4 , \
                  ], Steps \cf6 \strokec6 =\cf4 \strokec4  sorted.matrix[\cf7 \strokec7 "steps"\cf4 \strokec4 , ])))\
            \}\
            {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 else}} \{\
                {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/print.html"}}{\fldrslt \cf5 \strokec5 print}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/t.html"}}{\fldrslt \cf5 \strokec5 t}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/cbind.html"}}{\fldrslt \cf5 \strokec5 rbind}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/stats/aov.html"}}{\fldrslt \cf5 \strokec5 Error}} \cf6 \strokec6 =\cf4 \strokec4  sorted.matrix[\cf7 \strokec7 "error"\cf4 \strokec4 , \
                  ], \cf7 \strokec7 `Reached Threshold`\cf4 \strokec4  \cf6 \strokec6 =\cf4 \strokec4  sorted.matrix[\cf7 \strokec7 "reached.threshold"\cf4 \strokec4 , \
                  ], Steps \cf6 \strokec6 =\cf4 \strokec4  sorted.matrix[\cf7 \strokec7 "steps"\cf4 \strokec4 , ])))\
            \}\
        \}\
        {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 else}} \{\
            {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/cat.html"}}{\fldrslt \cf5 \strokec5 cat}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/nrow.html"}}{\fldrslt \cf5 \strokec5 ncol}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/matrix.html"}}{\fldrslt \cf5 \strokec5 matrix}}), \cf7 \strokec7 " repetition was calculated.\\n\\n"\cf4 \strokec4 , \
                sep \cf6 \strokec6 =\cf4 \strokec4  \cf7 \strokec7 ""\cf4 \strokec4 )\
            {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 if}} ({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/any.html"}}{\fldrslt \cf5 \strokec5 any}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/colnames.html"}}{\fldrslt \cf5 \strokec5 rownames}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/matrix.html"}}{\fldrslt \cf5 \strokec5 matrix}}) \cf6 \strokec6 ==\cf4 \strokec4  \cf7 \strokec7 "aic"\cf4 \strokec4 )) \{\
                {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/print.html"}}{\fldrslt \cf5 \strokec5 print}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/t.html"}}{\fldrslt \cf5 \strokec5 t}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/matrix.html"}}{\fldrslt \cf5 \strokec5 matrix}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/c.html"}}{\fldrslt \cf5 \strokec5 c}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/matrix.html"}}{\fldrslt \cf5 \strokec5 matrix}}[\cf7 \strokec7 "error"\cf4 \strokec4 , ], {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/matrix.html"}}{\fldrslt \cf5 \strokec5 matrix}}[\cf7 \strokec7 "aic"\cf4 \strokec4 , \
                  ], {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/matrix.html"}}{\fldrslt \cf5 \strokec5 matrix}}[\cf7 \strokec7 "bic"\cf4 \strokec4 , ], {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/matrix.html"}}{\fldrslt \cf5 \strokec5 matrix}}[\cf7 \strokec7 "reached.threshold"\cf4 \strokec4 , \
                  ], {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/matrix.html"}}{\fldrslt \cf5 \strokec5 matrix}}[\cf7 \strokec7 "steps"\cf4 \strokec4 , ]), {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/dimnames.html"}}{\fldrslt \cf5 \strokec5 dimnames}} \cf6 \strokec6 =\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/list.html"}}{\fldrslt \cf5 \strokec5 list}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/c.html"}}{\fldrslt \cf5 \strokec5 c}}(\cf7 \strokec7 "Error"\cf4 \strokec4 , \
                  \cf7 \strokec7 "AIC"\cf4 \strokec4 , \cf7 \strokec7 "BIC"\cf4 \strokec4 , \cf7 \strokec7 "Reached Threshold"\cf4 \strokec4 , \cf7 \strokec7 "Steps"\cf4 \strokec4 ), \
                  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/c.html"}}{\fldrslt \cf5 \strokec5 c}}(\cf6 \strokec6 1\cf4 \strokec4 )))))\
            \}\
            {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/Control.html"}}{\fldrslt \cf5 \strokec5 else}} \{\
                {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/print.html"}}{\fldrslt \cf5 \strokec5 print}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/t.html"}}{\fldrslt \cf5 \strokec5 t}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/matrix.html"}}{\fldrslt \cf5 \strokec5 matrix}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/c.html"}}{\fldrslt \cf5 \strokec5 c}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/matrix.html"}}{\fldrslt \cf5 \strokec5 matrix}}[\cf7 \strokec7 "error"\cf4 \strokec4 , ], {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/matrix.html"}}{\fldrslt \cf5 \strokec5 matrix}}[\cf7 \strokec7 "reached.threshold"\cf4 \strokec4 , \
                  ], {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/matrix.html"}}{\fldrslt \cf5 \strokec5 matrix}}[\cf7 \strokec7 "steps"\cf4 \strokec4 , ]), {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/dimnames.html"}}{\fldrslt \cf5 \strokec5 dimnames}} \cf6 \strokec6 =\cf4 \strokec4  {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/list.html"}}{\fldrslt \cf5 \strokec5 list}}({\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/c.html"}}{\fldrslt \cf5 \strokec5 c}}(\cf7 \strokec7 "Error"\cf4 \strokec4 , \
                  \cf7 \strokec7 "Reached Threshold"\cf4 \strokec4 , \cf7 \strokec7 "Steps"\cf4 \strokec4 ), {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/c.html"}}{\fldrslt \cf5 \strokec5 c}}(\cf6 \strokec6 1\cf4 \strokec4 )))))\
            \}\
        \}\
    \}\
    {\field{\*\fldinst{HYPERLINK "https://rdrr.io/r/base/cat.html"}}{\fldrslt \cf5 \strokec5 cat}}(\cf7 \strokec7 "\\n"\cf4 \strokec4 )\
\}\
}